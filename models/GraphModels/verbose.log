Command line
python GraphModel.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 128,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/rwthfs/rz/cluster/home/iz782675/SolubilityPrediction/data/random_undersampling.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 5,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'GraphModels',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': ['sol_category'],
 'target_weights': None,
 'task_names': ['sol_category'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 6,123 | train size = 4,898 | val size = 612 | test size = 613
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1272e+00, PNorm = 34.0513, GNorm = 0.4686, lr_0 = 2.3026e-04
Loss = 1.1076e+00, PNorm = 34.0511, GNorm = 0.6212, lr_0 = 3.4868e-04
Loss = 1.1041e+00, PNorm = 34.0527, GNorm = 0.5758, lr_0 = 4.6711e-04
Validation cross_entropy = 1.112387
Epoch 1
Loss = 1.1062e+00, PNorm = 34.0567, GNorm = 0.5116, lr_0 = 5.9737e-04
Loss = 1.1051e+00, PNorm = 34.0642, GNorm = 0.2661, lr_0 = 7.1579e-04
Loss = 1.1020e+00, PNorm = 34.0741, GNorm = 0.2659, lr_0 = 8.3421e-04
Loss = 1.1001e+00, PNorm = 34.0867, GNorm = 0.2209, lr_0 = 9.5263e-04
Validation cross_entropy = 1.102229
Epoch 2
Loss = 1.0977e+00, PNorm = 34.1002, GNorm = 0.2738, lr_0 = 9.9120e-04
Loss = 1.0968e+00, PNorm = 34.1149, GNorm = 0.1860, lr_0 = 9.7877e-04
Loss = 1.0982e+00, PNorm = 34.1299, GNorm = 0.2975, lr_0 = 9.6649e-04
Loss = 1.1036e+00, PNorm = 34.1410, GNorm = 0.4062, lr_0 = 9.5437e-04
Validation cross_entropy = 1.099722
Epoch 3
Loss = 1.0980e+00, PNorm = 34.1541, GNorm = 0.1483, lr_0 = 9.4120e-04
Loss = 1.0969e+00, PNorm = 34.1682, GNorm = 0.2870, lr_0 = 9.2940e-04
Loss = 1.0978e+00, PNorm = 34.1807, GNorm = 0.2609, lr_0 = 9.1774e-04
Loss = 1.0961e+00, PNorm = 34.1914, GNorm = 0.1253, lr_0 = 9.0623e-04
Validation cross_entropy = 1.097975
Epoch 4
Loss = 1.0910e+00, PNorm = 34.2056, GNorm = 0.1998, lr_0 = 8.9486e-04
Loss = 1.0969e+00, PNorm = 34.2201, GNorm = 0.1486, lr_0 = 8.8363e-04
Loss = 1.0984e+00, PNorm = 34.2375, GNorm = 0.3867, lr_0 = 8.7255e-04
Loss = 1.0943e+00, PNorm = 34.2526, GNorm = 0.2818, lr_0 = 8.6160e-04
Validation cross_entropy = 1.099583
Epoch 5
Loss = 1.0958e+00, PNorm = 34.2681, GNorm = 0.1599, lr_0 = 8.4972e-04
Loss = 1.0973e+00, PNorm = 34.2853, GNorm = 0.2958, lr_0 = 8.3906e-04
Loss = 1.0957e+00, PNorm = 34.3034, GNorm = 0.2035, lr_0 = 8.2854e-04
Validation cross_entropy = 1.094253
Epoch 6
Loss = 1.0831e+00, PNorm = 34.3276, GNorm = 0.1600, lr_0 = 8.1711e-04
Loss = 1.0951e+00, PNorm = 34.3483, GNorm = 0.1260, lr_0 = 8.0686e-04
Loss = 1.0956e+00, PNorm = 34.3696, GNorm = 0.2694, lr_0 = 7.9674e-04
Loss = 1.0971e+00, PNorm = 34.3873, GNorm = 0.1244, lr_0 = 7.8674e-04
Validation cross_entropy = 1.095907
Epoch 7
Loss = 1.0867e+00, PNorm = 34.4102, GNorm = 0.1335, lr_0 = 7.7589e-04
Loss = 1.0951e+00, PNorm = 34.4385, GNorm = 0.1611, lr_0 = 7.6616e-04
Loss = 1.0915e+00, PNorm = 34.4628, GNorm = 0.1262, lr_0 = 7.5655e-04
Loss = 1.0887e+00, PNorm = 34.4855, GNorm = 0.2124, lr_0 = 7.4706e-04
Validation cross_entropy = 1.096392
Epoch 8
Loss = 1.0834e+00, PNorm = 34.5098, GNorm = 0.3033, lr_0 = 7.3769e-04
Loss = 1.0869e+00, PNorm = 34.5417, GNorm = 0.3026, lr_0 = 7.2843e-04
Loss = 1.0922e+00, PNorm = 34.5748, GNorm = 0.1828, lr_0 = 7.1930e-04
Loss = 1.0893e+00, PNorm = 34.5982, GNorm = 0.2481, lr_0 = 7.1027e-04
Validation cross_entropy = 1.095816
Epoch 9
Loss = 1.0865e+00, PNorm = 34.6252, GNorm = 0.1638, lr_0 = 7.0048e-04
Loss = 1.0891e+00, PNorm = 34.6559, GNorm = 0.2061, lr_0 = 6.9169e-04
Loss = 1.0921e+00, PNorm = 34.6851, GNorm = 0.2179, lr_0 = 6.8301e-04
Loss = 1.0922e+00, PNorm = 34.7153, GNorm = 0.2072, lr_0 = 6.7445e-04
Validation cross_entropy = 1.098444
Epoch 10
Loss = 1.0903e+00, PNorm = 34.7480, GNorm = 0.2646, lr_0 = 6.6515e-04
Loss = 1.0842e+00, PNorm = 34.7744, GNorm = 0.1507, lr_0 = 6.5680e-04
Loss = 1.0921e+00, PNorm = 34.8063, GNorm = 0.1783, lr_0 = 6.4856e-04
Loss = 1.0853e+00, PNorm = 34.8377, GNorm = 0.1668, lr_0 = 6.4043e-04
Loss = 1.0690e+00, PNorm = 34.8415, GNorm = 0.3858, lr_0 = 6.3962e-04
Validation cross_entropy = 1.102489
Epoch 11
Loss = 1.0900e+00, PNorm = 34.8695, GNorm = 0.1949, lr_0 = 6.3159e-04
Loss = 1.0868e+00, PNorm = 34.9030, GNorm = 0.1434, lr_0 = 6.2367e-04
Loss = 1.0856e+00, PNorm = 34.9427, GNorm = 0.1734, lr_0 = 6.1585e-04
Validation cross_entropy = 1.108371
Epoch 12
Loss = 1.1065e+00, PNorm = 34.9755, GNorm = 0.2916, lr_0 = 6.0812e-04
Loss = 1.0829e+00, PNorm = 35.0095, GNorm = 0.2454, lr_0 = 6.0049e-04
Loss = 1.0790e+00, PNorm = 35.0499, GNorm = 0.3128, lr_0 = 5.9296e-04
Loss = 1.0854e+00, PNorm = 35.0885, GNorm = 0.3744, lr_0 = 5.8552e-04
Validation cross_entropy = 1.111024
Epoch 13
Loss = 1.0844e+00, PNorm = 35.1267, GNorm = 0.1956, lr_0 = 5.7745e-04
Loss = 1.0738e+00, PNorm = 35.1665, GNorm = 0.1695, lr_0 = 5.7020e-04
Loss = 1.0908e+00, PNorm = 35.1961, GNorm = 0.3485, lr_0 = 5.6305e-04
Loss = 1.0790e+00, PNorm = 35.2271, GNorm = 0.5169, lr_0 = 5.5599e-04
Validation cross_entropy = 1.111751
Epoch 14
Loss = 1.0841e+00, PNorm = 35.2660, GNorm = 0.2719, lr_0 = 5.4832e-04
Loss = 1.0744e+00, PNorm = 35.3059, GNorm = 0.3355, lr_0 = 5.4144e-04
Loss = 1.0807e+00, PNorm = 35.3409, GNorm = 0.3614, lr_0 = 5.3465e-04
Loss = 1.0810e+00, PNorm = 35.3774, GNorm = 0.1731, lr_0 = 5.2794e-04
Validation cross_entropy = 1.107649
Epoch 15
Loss = 1.0813e+00, PNorm = 35.4155, GNorm = 0.2199, lr_0 = 5.2066e-04
Loss = 1.0716e+00, PNorm = 35.4514, GNorm = 0.4373, lr_0 = 5.1413e-04
Loss = 1.0634e+00, PNorm = 35.4973, GNorm = 0.3657, lr_0 = 5.0768e-04
Loss = 1.0860e+00, PNorm = 35.5290, GNorm = 0.3731, lr_0 = 5.0131e-04
Validation cross_entropy = 1.106549
Epoch 16
Loss = 1.0774e+00, PNorm = 35.5603, GNorm = 0.4693, lr_0 = 4.9503e-04
Loss = 1.0751e+00, PNorm = 35.5957, GNorm = 0.2289, lr_0 = 4.8882e-04
Loss = 1.0713e+00, PNorm = 35.6328, GNorm = 0.1890, lr_0 = 4.8268e-04
Loss = 1.0770e+00, PNorm = 35.6638, GNorm = 0.3706, lr_0 = 4.7663e-04
Loss = 1.1068e+00, PNorm = 35.6667, GNorm = 0.5591, lr_0 = 4.7603e-04
Validation cross_entropy = 1.118044
Epoch 17
Loss = 1.0748e+00, PNorm = 35.6995, GNorm = 0.1896, lr_0 = 4.7006e-04
Loss = 1.0743e+00, PNorm = 35.7324, GNorm = 0.2887, lr_0 = 4.6416e-04
Loss = 1.0701e+00, PNorm = 35.7677, GNorm = 0.2842, lr_0 = 4.5834e-04
Validation cross_entropy = 1.114143
Epoch 18
Loss = 1.0587e+00, PNorm = 35.8044, GNorm = 0.4078, lr_0 = 4.5202e-04
Loss = 1.0722e+00, PNorm = 35.8410, GNorm = 0.4503, lr_0 = 4.4635e-04
Loss = 1.0622e+00, PNorm = 35.8773, GNorm = 0.2063, lr_0 = 4.4075e-04
Loss = 1.0745e+00, PNorm = 35.9115, GNorm = 0.2978, lr_0 = 4.3522e-04
Validation cross_entropy = 1.117475
Epoch 19
Loss = 1.0676e+00, PNorm = 35.9394, GNorm = 0.3164, lr_0 = 4.2976e-04
Loss = 1.0663e+00, PNorm = 35.9720, GNorm = 0.2893, lr_0 = 4.2437e-04
Loss = 1.0632e+00, PNorm = 36.0054, GNorm = 0.2019, lr_0 = 4.1904e-04
Loss = 1.0619e+00, PNorm = 36.0396, GNorm = 0.4590, lr_0 = 4.1379e-04
Validation cross_entropy = 1.120918
Epoch 20
Loss = 1.0571e+00, PNorm = 36.0784, GNorm = 0.2499, lr_0 = 4.0808e-04
Loss = 1.0716e+00, PNorm = 36.1103, GNorm = 0.2201, lr_0 = 4.0296e-04
Loss = 1.0674e+00, PNorm = 36.1365, GNorm = 0.2957, lr_0 = 3.9791e-04
Loss = 1.0567e+00, PNorm = 36.1686, GNorm = 0.4688, lr_0 = 3.9291e-04
Validation cross_entropy = 1.123104
Epoch 21
Loss = 1.0618e+00, PNorm = 36.2050, GNorm = 0.5895, lr_0 = 3.8750e-04
Loss = 1.0531e+00, PNorm = 36.2422, GNorm = 0.4081, lr_0 = 3.8264e-04
Loss = 1.0730e+00, PNorm = 36.2682, GNorm = 0.3252, lr_0 = 3.7784e-04
Loss = 1.0609e+00, PNorm = 36.3004, GNorm = 0.1976, lr_0 = 3.7310e-04
Validation cross_entropy = 1.116453
Epoch 22
Loss = 1.0488e+00, PNorm = 36.3314, GNorm = 0.2986, lr_0 = 3.6795e-04
Loss = 1.0621e+00, PNorm = 36.3650, GNorm = 0.5257, lr_0 = 3.6333e-04
Loss = 1.0691e+00, PNorm = 36.3976, GNorm = 0.2517, lr_0 = 3.5878e-04
Loss = 1.0576e+00, PNorm = 36.4236, GNorm = 0.8986, lr_0 = 3.5428e-04
Validation cross_entropy = 1.127758
Epoch 23
Loss = 1.0541e+00, PNorm = 36.4542, GNorm = 0.3115, lr_0 = 3.4983e-04
Loss = 1.0634e+00, PNorm = 36.4852, GNorm = 0.5002, lr_0 = 3.4544e-04
Loss = 1.0567e+00, PNorm = 36.5131, GNorm = 0.3371, lr_0 = 3.4111e-04
Validation cross_entropy = 1.118578
Epoch 24
Loss = 1.0573e+00, PNorm = 36.5420, GNorm = 0.2899, lr_0 = 3.3641e-04
Loss = 1.0569e+00, PNorm = 36.5711, GNorm = 0.5678, lr_0 = 3.3219e-04
Loss = 1.0405e+00, PNorm = 36.6004, GNorm = 0.3609, lr_0 = 3.2802e-04
Loss = 1.0449e+00, PNorm = 36.6302, GNorm = 0.4572, lr_0 = 3.2390e-04
Validation cross_entropy = 1.124248
Epoch 25
Loss = 1.0559e+00, PNorm = 36.6609, GNorm = 0.4710, lr_0 = 3.1944e-04
Loss = 1.0569e+00, PNorm = 36.6886, GNorm = 0.3795, lr_0 = 3.1543e-04
Loss = 1.0462e+00, PNorm = 36.7137, GNorm = 0.4085, lr_0 = 3.1147e-04
Loss = 1.0397e+00, PNorm = 36.7437, GNorm = 0.6536, lr_0 = 3.0757e-04
Validation cross_entropy = 1.125149
Epoch 26
Loss = 1.0342e+00, PNorm = 36.7705, GNorm = 0.5300, lr_0 = 3.0332e-04
Loss = 1.0398e+00, PNorm = 36.8007, GNorm = 0.8004, lr_0 = 2.9952e-04
Loss = 1.0517e+00, PNorm = 36.8277, GNorm = 0.5654, lr_0 = 2.9576e-04
Loss = 1.0618e+00, PNorm = 36.8502, GNorm = 0.2219, lr_0 = 2.9205e-04
Validation cross_entropy = 1.130720
Epoch 27
Loss = 1.0438e+00, PNorm = 36.8748, GNorm = 0.3725, lr_0 = 2.8839e-04
Loss = 1.0309e+00, PNorm = 36.9011, GNorm = 0.4883, lr_0 = 2.8477e-04
Loss = 1.0287e+00, PNorm = 36.9302, GNorm = 0.5112, lr_0 = 2.8120e-04
Loss = 1.0458e+00, PNorm = 36.9536, GNorm = 0.4007, lr_0 = 2.7767e-04
Validation cross_entropy = 1.142471
Epoch 28
Loss = 1.0369e+00, PNorm = 36.9805, GNorm = 0.3660, lr_0 = 2.7384e-04
Loss = 1.0399e+00, PNorm = 37.0032, GNorm = 0.4027, lr_0 = 2.7041e-04
Loss = 1.0386e+00, PNorm = 37.0289, GNorm = 0.4440, lr_0 = 2.6701e-04
Validation cross_entropy = 1.148464
Epoch 29
Loss = 1.0568e+00, PNorm = 37.0536, GNorm = 0.7975, lr_0 = 2.6333e-04
Loss = 1.0326e+00, PNorm = 37.0817, GNorm = 0.4141, lr_0 = 2.6003e-04
Loss = 1.0347e+00, PNorm = 37.1031, GNorm = 0.4285, lr_0 = 2.5677e-04
Loss = 1.0344e+00, PNorm = 37.1259, GNorm = 0.4632, lr_0 = 2.5355e-04
Validation cross_entropy = 1.142271
Epoch 30
Loss = 1.0296e+00, PNorm = 37.1510, GNorm = 0.9207, lr_0 = 2.5005e-04
Loss = 1.0386e+00, PNorm = 37.1782, GNorm = 0.3688, lr_0 = 2.4691e-04
Loss = 1.0442e+00, PNorm = 37.1987, GNorm = 0.5215, lr_0 = 2.4382e-04
Loss = 1.0162e+00, PNorm = 37.2192, GNorm = 0.5558, lr_0 = 2.4076e-04
Validation cross_entropy = 1.139701
Epoch 31
Loss = 1.0374e+00, PNorm = 37.2407, GNorm = 1.0251, lr_0 = 2.3774e-04
Loss = 1.0338e+00, PNorm = 37.2620, GNorm = 0.6344, lr_0 = 2.3475e-04
Loss = 1.0330e+00, PNorm = 37.2860, GNorm = 0.4736, lr_0 = 2.3181e-04
Loss = 1.0221e+00, PNorm = 37.3067, GNorm = 0.4483, lr_0 = 2.2890e-04
Validation cross_entropy = 1.137887
Epoch 32
Loss = 1.0146e+00, PNorm = 37.3306, GNorm = 0.4733, lr_0 = 2.2575e-04
Loss = 1.0269e+00, PNorm = 37.3529, GNorm = 0.4315, lr_0 = 2.2291e-04
Loss = 1.0161e+00, PNorm = 37.3749, GNorm = 0.5110, lr_0 = 2.2012e-04
Loss = 1.0422e+00, PNorm = 37.3940, GNorm = 0.8119, lr_0 = 2.1736e-04
Validation cross_entropy = 1.140908
Epoch 33
Loss = 1.0274e+00, PNorm = 37.4170, GNorm = 0.4316, lr_0 = 2.1436e-04
Loss = 1.0199e+00, PNorm = 37.4391, GNorm = 0.6870, lr_0 = 2.1167e-04
Loss = 1.0308e+00, PNorm = 37.4586, GNorm = 0.4913, lr_0 = 2.0901e-04
Loss = 1.0149e+00, PNorm = 37.4768, GNorm = 0.6706, lr_0 = 2.0639e-04
Validation cross_entropy = 1.133638
Epoch 34
Loss = 1.0320e+00, PNorm = 37.4958, GNorm = 0.5491, lr_0 = 2.0380e-04
Loss = 1.0177e+00, PNorm = 37.5142, GNorm = 0.4868, lr_0 = 2.0125e-04
Loss = 1.0058e+00, PNorm = 37.5343, GNorm = 0.7985, lr_0 = 1.9872e-04
Validation cross_entropy = 1.137126
Epoch 35
Loss = 1.0493e+00, PNorm = 37.5552, GNorm = 0.6964, lr_0 = 1.9598e-04
Loss = 1.0111e+00, PNorm = 37.5750, GNorm = 0.5431, lr_0 = 1.9352e-04
Loss = 1.0105e+00, PNorm = 37.5924, GNorm = 0.5069, lr_0 = 1.9110e-04
Loss = 1.0096e+00, PNorm = 37.6113, GNorm = 0.5300, lr_0 = 1.8870e-04
Validation cross_entropy = 1.139682
Epoch 36
Loss = 9.8631e-01, PNorm = 37.6297, GNorm = 0.5805, lr_0 = 1.8610e-04
Loss = 1.0139e+00, PNorm = 37.6472, GNorm = 0.6148, lr_0 = 1.8376e-04
Loss = 1.0021e+00, PNorm = 37.6643, GNorm = 0.5672, lr_0 = 1.8146e-04
Loss = 1.0183e+00, PNorm = 37.6818, GNorm = 0.6297, lr_0 = 1.7918e-04
Validation cross_entropy = 1.149369
Epoch 37
Loss = 9.8739e-01, PNorm = 37.6996, GNorm = 0.8427, lr_0 = 1.7671e-04
Loss = 1.0187e+00, PNorm = 37.7147, GNorm = 0.9424, lr_0 = 1.7449e-04
Loss = 9.9957e-01, PNorm = 37.7324, GNorm = 0.9865, lr_0 = 1.7230e-04
Loss = 1.0131e+00, PNorm = 37.7487, GNorm = 0.4554, lr_0 = 1.7014e-04
Validation cross_entropy = 1.146255
Epoch 38
Loss = 9.9732e-01, PNorm = 37.7652, GNorm = 1.1950, lr_0 = 1.6801e-04
Loss = 1.0040e+00, PNorm = 37.7812, GNorm = 0.7792, lr_0 = 1.6590e-04
Loss = 1.0177e+00, PNorm = 37.7965, GNorm = 0.5924, lr_0 = 1.6382e-04
Loss = 1.0030e+00, PNorm = 37.8108, GNorm = 0.5635, lr_0 = 1.6176e-04
Validation cross_entropy = 1.161959
Epoch 39
Loss = 1.0197e+00, PNorm = 37.8267, GNorm = 0.8827, lr_0 = 1.5953e-04
Loss = 9.9711e-01, PNorm = 37.8417, GNorm = 0.6255, lr_0 = 1.5753e-04
Loss = 9.8884e-01, PNorm = 37.8576, GNorm = 0.4740, lr_0 = 1.5556e-04
Loss = 1.0069e+00, PNorm = 37.8707, GNorm = 0.6089, lr_0 = 1.5360e-04
Loss = 9.3095e-01, PNorm = 37.8720, GNorm = 1.2760, lr_0 = 1.5341e-04
Validation cross_entropy = 1.158059
Epoch 40
Loss = 9.9604e-01, PNorm = 37.8864, GNorm = 0.6524, lr_0 = 1.5149e-04
Loss = 1.0029e+00, PNorm = 37.8990, GNorm = 0.5778, lr_0 = 1.4959e-04
Loss = 9.9365e-01, PNorm = 37.9136, GNorm = 0.8717, lr_0 = 1.4771e-04
Validation cross_entropy = 1.165303
Epoch 41
Loss = 9.8793e-01, PNorm = 37.9285, GNorm = 0.5761, lr_0 = 1.4567e-04
Loss = 9.8981e-01, PNorm = 37.9421, GNorm = 0.6347, lr_0 = 1.4384e-04
Loss = 9.9382e-01, PNorm = 37.9559, GNorm = 0.7292, lr_0 = 1.4204e-04
Loss = 9.9899e-01, PNorm = 37.9704, GNorm = 1.1770, lr_0 = 1.4026e-04
Validation cross_entropy = 1.185997
Epoch 42
Loss = 9.7812e-01, PNorm = 37.9833, GNorm = 0.8742, lr_0 = 1.3850e-04
Loss = 9.9359e-01, PNorm = 37.9962, GNorm = 0.5618, lr_0 = 1.3676e-04
Loss = 9.9647e-01, PNorm = 38.0104, GNorm = 0.8847, lr_0 = 1.3505e-04
Loss = 1.0056e+00, PNorm = 38.0211, GNorm = 0.5905, lr_0 = 1.3335e-04
Validation cross_entropy = 1.163882
Epoch 43
Loss = 9.5093e-01, PNorm = 38.0341, GNorm = 0.9441, lr_0 = 1.3151e-04
Loss = 9.7837e-01, PNorm = 38.0485, GNorm = 0.7875, lr_0 = 1.2986e-04
Loss = 9.9479e-01, PNorm = 38.0612, GNorm = 0.8182, lr_0 = 1.2823e-04
Loss = 9.9597e-01, PNorm = 38.0734, GNorm = 1.4126, lr_0 = 1.2663e-04
Validation cross_entropy = 1.169723
Epoch 44
Loss = 1.0060e+00, PNorm = 38.0840, GNorm = 0.8116, lr_0 = 1.2488e-04
Loss = 9.8656e-01, PNorm = 38.0944, GNorm = 0.7005, lr_0 = 1.2331e-04
Loss = 9.9130e-01, PNorm = 38.1048, GNorm = 0.6941, lr_0 = 1.2177e-04
Loss = 9.8709e-01, PNorm = 38.1164, GNorm = 0.8690, lr_0 = 1.2024e-04
Validation cross_entropy = 1.166092
Epoch 45
Loss = 9.8092e-01, PNorm = 38.1285, GNorm = 0.9202, lr_0 = 1.1858e-04
Loss = 9.7587e-01, PNorm = 38.1395, GNorm = 0.8464, lr_0 = 1.1709e-04
Loss = 9.8914e-01, PNorm = 38.1501, GNorm = 0.7482, lr_0 = 1.1562e-04
Loss = 1.0021e+00, PNorm = 38.1599, GNorm = 3.1366, lr_0 = 1.1417e-04
Validation cross_entropy = 1.171682
Epoch 46
Loss = 9.9780e-01, PNorm = 38.1702, GNorm = 0.5728, lr_0 = 1.1274e-04
Loss = 9.7928e-01, PNorm = 38.1802, GNorm = 1.2713, lr_0 = 1.1133e-04
Loss = 9.7911e-01, PNorm = 38.1905, GNorm = 0.6054, lr_0 = 1.0993e-04
Validation cross_entropy = 1.179910
Epoch 47
Loss = 9.2386e-01, PNorm = 38.2006, GNorm = 0.6417, lr_0 = 1.0841e-04
Loss = 9.7291e-01, PNorm = 38.2113, GNorm = 0.8918, lr_0 = 1.0705e-04
Loss = 9.8614e-01, PNorm = 38.2213, GNorm = 0.6833, lr_0 = 1.0571e-04
Loss = 9.8569e-01, PNorm = 38.2311, GNorm = 0.7469, lr_0 = 1.0439e-04
Validation cross_entropy = 1.177227
Epoch 48
Loss = 9.6148e-01, PNorm = 38.2409, GNorm = 0.8228, lr_0 = 1.0295e-04
Loss = 9.9316e-01, PNorm = 38.2497, GNorm = 0.7554, lr_0 = 1.0165e-04
Loss = 9.7401e-01, PNorm = 38.2580, GNorm = 0.6182, lr_0 = 1.0038e-04
Loss = 9.6923e-01, PNorm = 38.2673, GNorm = 1.0644, lr_0 = 1.0000e-04
Validation cross_entropy = 1.178636
Epoch 49
Loss = 9.8864e-01, PNorm = 38.2780, GNorm = 1.0382, lr_0 = 1.0000e-04
Loss = 9.6493e-01, PNorm = 38.2864, GNorm = 0.6376, lr_0 = 1.0000e-04
Loss = 9.7095e-01, PNorm = 38.2957, GNorm = 1.1110, lr_0 = 1.0000e-04
Loss = 9.7799e-01, PNorm = 38.3053, GNorm = 0.8935, lr_0 = 1.0000e-04
Validation cross_entropy = 1.177559
Model 0 best validation cross_entropy = 1.094253 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 1.102839
Building model 1
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1205e+00, PNorm = 34.0883, GNorm = 2.0197, lr_0 = 2.3026e-04
Loss = 1.1087e+00, PNorm = 34.0885, GNorm = 1.4573, lr_0 = 3.4868e-04
Loss = 1.1131e+00, PNorm = 34.0893, GNorm = 0.5708, lr_0 = 4.6711e-04
Validation cross_entropy = 1.098987
Epoch 1
Loss = 1.1050e+00, PNorm = 34.0934, GNorm = 0.6182, lr_0 = 5.9737e-04
Loss = 1.1081e+00, PNorm = 34.1006, GNorm = 0.4174, lr_0 = 7.1579e-04
Loss = 1.1032e+00, PNorm = 34.1099, GNorm = 0.2791, lr_0 = 8.3421e-04
Loss = 1.1036e+00, PNorm = 34.1211, GNorm = 0.6082, lr_0 = 9.5263e-04
Validation cross_entropy = 1.100223
Epoch 2
Loss = 1.0986e+00, PNorm = 34.1352, GNorm = 0.3446, lr_0 = 9.9120e-04
Loss = 1.1001e+00, PNorm = 34.1494, GNorm = 0.2448, lr_0 = 9.7877e-04
Loss = 1.1008e+00, PNorm = 34.1629, GNorm = 0.4658, lr_0 = 9.6649e-04
Loss = 1.1000e+00, PNorm = 34.1743, GNorm = 0.3278, lr_0 = 9.5437e-04
Validation cross_entropy = 1.097832
Epoch 3
Loss = 1.0934e+00, PNorm = 34.1890, GNorm = 0.2571, lr_0 = 9.4120e-04
Loss = 1.0963e+00, PNorm = 34.2034, GNorm = 0.2898, lr_0 = 9.2940e-04
Loss = 1.0981e+00, PNorm = 34.2172, GNorm = 0.2300, lr_0 = 9.1774e-04
Loss = 1.0968e+00, PNorm = 34.2306, GNorm = 0.1669, lr_0 = 9.0623e-04
Validation cross_entropy = 1.106115
Epoch 4
Loss = 1.0955e+00, PNorm = 34.2458, GNorm = 0.3852, lr_0 = 8.9486e-04
Loss = 1.0952e+00, PNorm = 34.2616, GNorm = 0.2008, lr_0 = 8.8363e-04
Loss = 1.0937e+00, PNorm = 34.2783, GNorm = 0.1746, lr_0 = 8.7255e-04
Loss = 1.0980e+00, PNorm = 34.2933, GNorm = 0.2849, lr_0 = 8.6160e-04
Validation cross_entropy = 1.095868
Epoch 5
Loss = 1.0991e+00, PNorm = 34.3090, GNorm = 0.1677, lr_0 = 8.4972e-04
Loss = 1.0979e+00, PNorm = 34.3277, GNorm = 0.1381, lr_0 = 8.3906e-04
Loss = 1.0967e+00, PNorm = 34.3446, GNorm = 0.2008, lr_0 = 8.2854e-04
Validation cross_entropy = 1.107771
Epoch 6
Loss = 1.0937e+00, PNorm = 34.3657, GNorm = 0.2361, lr_0 = 8.1711e-04
Loss = 1.0896e+00, PNorm = 34.3854, GNorm = 0.3476, lr_0 = 8.0686e-04
Loss = 1.0939e+00, PNorm = 34.4041, GNorm = 0.1449, lr_0 = 7.9674e-04
Loss = 1.0994e+00, PNorm = 34.4243, GNorm = 0.1547, lr_0 = 7.8674e-04
Validation cross_entropy = 1.095738
Epoch 7
Loss = 1.0926e+00, PNorm = 34.4439, GNorm = 0.1043, lr_0 = 7.7589e-04
Loss = 1.0901e+00, PNorm = 34.4685, GNorm = 0.1387, lr_0 = 7.6616e-04
Loss = 1.0913e+00, PNorm = 34.4975, GNorm = 0.4383, lr_0 = 7.5655e-04
Loss = 1.0915e+00, PNorm = 34.5249, GNorm = 0.2748, lr_0 = 7.4706e-04
Validation cross_entropy = 1.101434
Epoch 8
Loss = 1.0940e+00, PNorm = 34.5460, GNorm = 0.2116, lr_0 = 7.3769e-04
Loss = 1.0934e+00, PNorm = 34.5696, GNorm = 0.2081, lr_0 = 7.2843e-04
Loss = 1.0891e+00, PNorm = 34.5957, GNorm = 0.3636, lr_0 = 7.1930e-04
Loss = 1.0860e+00, PNorm = 34.6256, GNorm = 0.2914, lr_0 = 7.1027e-04
Validation cross_entropy = 1.097312
Epoch 9
Loss = 1.0880e+00, PNorm = 34.6460, GNorm = 0.1747, lr_0 = 7.0048e-04
Loss = 1.0927e+00, PNorm = 34.6744, GNorm = 0.2018, lr_0 = 6.9169e-04
Loss = 1.0863e+00, PNorm = 34.7027, GNorm = 0.1492, lr_0 = 6.8301e-04
Loss = 1.0921e+00, PNorm = 34.7310, GNorm = 0.1287, lr_0 = 6.7445e-04
Validation cross_entropy = 1.096907
Epoch 10
Loss = 1.0875e+00, PNorm = 34.7652, GNorm = 0.2932, lr_0 = 6.6515e-04
Loss = 1.0857e+00, PNorm = 34.7947, GNorm = 0.2636, lr_0 = 6.5680e-04
Loss = 1.0881e+00, PNorm = 34.8266, GNorm = 0.1480, lr_0 = 6.4856e-04
Loss = 1.0876e+00, PNorm = 34.8585, GNorm = 0.2328, lr_0 = 6.4043e-04
Loss = 1.0635e+00, PNorm = 34.8618, GNorm = 0.4318, lr_0 = 6.3962e-04
Validation cross_entropy = 1.093781
Epoch 11
Loss = 1.0890e+00, PNorm = 34.8954, GNorm = 0.2975, lr_0 = 6.3159e-04
Loss = 1.0847e+00, PNorm = 34.9329, GNorm = 0.3374, lr_0 = 6.2367e-04
Loss = 1.0864e+00, PNorm = 34.9691, GNorm = 0.2465, lr_0 = 6.1585e-04
Validation cross_entropy = 1.096960
Epoch 12
Loss = 1.0831e+00, PNorm = 34.9937, GNorm = 0.2023, lr_0 = 6.0812e-04
Loss = 1.0837e+00, PNorm = 35.0285, GNorm = 0.1831, lr_0 = 6.0049e-04
Loss = 1.0872e+00, PNorm = 35.0559, GNorm = 0.2617, lr_0 = 5.9296e-04
Loss = 1.0768e+00, PNorm = 35.0859, GNorm = 0.1640, lr_0 = 5.8552e-04
Validation cross_entropy = 1.104527
Epoch 13
Loss = 1.0719e+00, PNorm = 35.1208, GNorm = 0.1996, lr_0 = 5.7745e-04
Loss = 1.0793e+00, PNorm = 35.1572, GNorm = 0.2177, lr_0 = 5.7020e-04
Loss = 1.0885e+00, PNorm = 35.1895, GNorm = 0.1965, lr_0 = 5.6305e-04
Loss = 1.0794e+00, PNorm = 35.2204, GNorm = 0.1489, lr_0 = 5.5599e-04
Validation cross_entropy = 1.095510
Epoch 14
Loss = 1.0829e+00, PNorm = 35.2559, GNorm = 0.1939, lr_0 = 5.4832e-04
Loss = 1.0789e+00, PNorm = 35.2894, GNorm = 0.2495, lr_0 = 5.4144e-04
Loss = 1.0780e+00, PNorm = 35.3247, GNorm = 0.2338, lr_0 = 5.3465e-04
Loss = 1.0778e+00, PNorm = 35.3616, GNorm = 0.3079, lr_0 = 5.2794e-04
Validation cross_entropy = 1.099400
Epoch 15
Loss = 1.0773e+00, PNorm = 35.3970, GNorm = 0.2730, lr_0 = 5.2066e-04
Loss = 1.0776e+00, PNorm = 35.4315, GNorm = 0.3843, lr_0 = 5.1413e-04
Loss = 1.0719e+00, PNorm = 35.4694, GNorm = 0.2465, lr_0 = 5.0768e-04
Loss = 1.0834e+00, PNorm = 35.4992, GNorm = 0.4179, lr_0 = 5.0131e-04
Validation cross_entropy = 1.099523
Epoch 16
Loss = 1.0717e+00, PNorm = 35.5282, GNorm = 0.2421, lr_0 = 4.9503e-04
Loss = 1.0750e+00, PNorm = 35.5624, GNorm = 0.3392, lr_0 = 4.8882e-04
Loss = 1.0704e+00, PNorm = 35.5967, GNorm = 0.2784, lr_0 = 4.8268e-04
Loss = 1.0754e+00, PNorm = 35.6300, GNorm = 0.4809, lr_0 = 4.7663e-04
Loss = 1.0978e+00, PNorm = 35.6335, GNorm = 0.9230, lr_0 = 4.7603e-04
Validation cross_entropy = 1.113445
Epoch 17
Loss = 1.0674e+00, PNorm = 35.6699, GNorm = 0.3006, lr_0 = 4.7006e-04
Loss = 1.0738e+00, PNorm = 35.7008, GNorm = 0.2715, lr_0 = 4.6416e-04
Loss = 1.0730e+00, PNorm = 35.7399, GNorm = 0.3725, lr_0 = 4.5834e-04
Validation cross_entropy = 1.105067
Epoch 18
Loss = 1.0694e+00, PNorm = 35.7703, GNorm = 0.2934, lr_0 = 4.5202e-04
Loss = 1.0700e+00, PNorm = 35.7958, GNorm = 0.2376, lr_0 = 4.4635e-04
Loss = 1.0712e+00, PNorm = 35.8288, GNorm = 0.2370, lr_0 = 4.4075e-04
Loss = 1.0764e+00, PNorm = 35.8604, GNorm = 0.2606, lr_0 = 4.3522e-04
Validation cross_entropy = 1.110047
Epoch 19
Loss = 1.0598e+00, PNorm = 35.8895, GNorm = 0.4362, lr_0 = 4.2976e-04
Loss = 1.0660e+00, PNorm = 35.9272, GNorm = 0.3545, lr_0 = 4.2437e-04
Loss = 1.0593e+00, PNorm = 35.9638, GNorm = 0.2818, lr_0 = 4.1904e-04
Loss = 1.0749e+00, PNorm = 35.9953, GNorm = 0.3771, lr_0 = 4.1379e-04
Validation cross_entropy = 1.115956
Epoch 20
Loss = 1.0482e+00, PNorm = 36.0180, GNorm = 0.2899, lr_0 = 4.0808e-04
Loss = 1.0693e+00, PNorm = 36.0488, GNorm = 0.3519, lr_0 = 4.0296e-04
Loss = 1.0666e+00, PNorm = 36.0813, GNorm = 0.3486, lr_0 = 3.9791e-04
Loss = 1.0670e+00, PNorm = 36.1078, GNorm = 0.2931, lr_0 = 3.9291e-04
Validation cross_entropy = 1.104343
Epoch 21
Loss = 1.0637e+00, PNorm = 36.1402, GNorm = 0.4317, lr_0 = 3.8750e-04
Loss = 1.0697e+00, PNorm = 36.1683, GNorm = 0.3093, lr_0 = 3.8264e-04
Loss = 1.0619e+00, PNorm = 36.1990, GNorm = 0.2266, lr_0 = 3.7784e-04
Loss = 1.0593e+00, PNorm = 36.2301, GNorm = 0.6762, lr_0 = 3.7310e-04
Validation cross_entropy = 1.125209
Epoch 22
Loss = 1.0596e+00, PNorm = 36.2584, GNorm = 0.2805, lr_0 = 3.6795e-04
Loss = 1.0568e+00, PNorm = 36.2854, GNorm = 0.4404, lr_0 = 3.6333e-04
Loss = 1.0640e+00, PNorm = 36.3153, GNorm = 0.3210, lr_0 = 3.5878e-04
Loss = 1.0434e+00, PNorm = 36.3413, GNorm = 0.4717, lr_0 = 3.5428e-04
Validation cross_entropy = 1.132802
Epoch 23
Loss = 1.0532e+00, PNorm = 36.3722, GNorm = 0.4658, lr_0 = 3.4983e-04
Loss = 1.0591e+00, PNorm = 36.3992, GNorm = 0.6038, lr_0 = 3.4544e-04
Loss = 1.0695e+00, PNorm = 36.4304, GNorm = 0.5002, lr_0 = 3.4111e-04
Validation cross_entropy = 1.111641
Epoch 24
Loss = 1.0563e+00, PNorm = 36.4581, GNorm = 0.3508, lr_0 = 3.3641e-04
Loss = 1.0537e+00, PNorm = 36.4824, GNorm = 0.3130, lr_0 = 3.3219e-04
Loss = 1.0671e+00, PNorm = 36.5078, GNorm = 0.3500, lr_0 = 3.2802e-04
Loss = 1.0433e+00, PNorm = 36.5367, GNorm = 0.4003, lr_0 = 3.2390e-04
Validation cross_entropy = 1.122478
Epoch 25
Loss = 1.0583e+00, PNorm = 36.5670, GNorm = 0.3747, lr_0 = 3.1944e-04
Loss = 1.0446e+00, PNorm = 36.5984, GNorm = 0.3931, lr_0 = 3.1543e-04
Loss = 1.0532e+00, PNorm = 36.6263, GNorm = 0.4305, lr_0 = 3.1147e-04
Loss = 1.0460e+00, PNorm = 36.6491, GNorm = 0.4459, lr_0 = 3.0757e-04
Validation cross_entropy = 1.117848
Epoch 26
Loss = 1.0227e+00, PNorm = 36.6794, GNorm = 0.3917, lr_0 = 3.0332e-04
Loss = 1.0643e+00, PNorm = 36.7081, GNorm = 0.3642, lr_0 = 2.9952e-04
Loss = 1.0469e+00, PNorm = 36.7355, GNorm = 0.3818, lr_0 = 2.9576e-04
Loss = 1.0491e+00, PNorm = 36.7582, GNorm = 0.4362, lr_0 = 2.9205e-04
Validation cross_entropy = 1.124782
Epoch 27
Loss = 1.0494e+00, PNorm = 36.7811, GNorm = 0.4718, lr_0 = 2.8839e-04
Loss = 1.0461e+00, PNorm = 36.8082, GNorm = 0.3537, lr_0 = 2.8477e-04
Loss = 1.0408e+00, PNorm = 36.8327, GNorm = 0.3825, lr_0 = 2.8120e-04
Loss = 1.0523e+00, PNorm = 36.8565, GNorm = 0.3778, lr_0 = 2.7767e-04
Validation cross_entropy = 1.122875
Epoch 28
Loss = 1.0404e+00, PNorm = 36.8753, GNorm = 0.4767, lr_0 = 2.7384e-04
Loss = 1.0448e+00, PNorm = 36.8983, GNorm = 0.3991, lr_0 = 2.7041e-04
Loss = 1.0448e+00, PNorm = 36.9206, GNorm = 0.4485, lr_0 = 2.6701e-04
Validation cross_entropy = 1.133583
Epoch 29
Loss = 1.0617e+00, PNorm = 36.9494, GNorm = 0.6694, lr_0 = 2.6333e-04
Loss = 1.0540e+00, PNorm = 36.9716, GNorm = 0.6365, lr_0 = 2.6003e-04
Loss = 1.0306e+00, PNorm = 36.9942, GNorm = 0.6774, lr_0 = 2.5677e-04
Loss = 1.0352e+00, PNorm = 37.0160, GNorm = 0.4488, lr_0 = 2.5355e-04
Validation cross_entropy = 1.125339
Epoch 30
Loss = 1.0404e+00, PNorm = 37.0389, GNorm = 0.3511, lr_0 = 2.5005e-04
Loss = 1.0326e+00, PNorm = 37.0620, GNorm = 0.6741, lr_0 = 2.4691e-04
Loss = 1.0241e+00, PNorm = 37.0861, GNorm = 0.5955, lr_0 = 2.4382e-04
Loss = 1.0479e+00, PNorm = 37.1091, GNorm = 0.3672, lr_0 = 2.4076e-04
Validation cross_entropy = 1.138621
Epoch 31
Loss = 1.0278e+00, PNorm = 37.1286, GNorm = 0.5242, lr_0 = 2.3774e-04
Loss = 1.0334e+00, PNorm = 37.1520, GNorm = 0.4053, lr_0 = 2.3475e-04
Loss = 1.0372e+00, PNorm = 37.1740, GNorm = 0.6729, lr_0 = 2.3181e-04
Loss = 1.0435e+00, PNorm = 37.1934, GNorm = 0.4902, lr_0 = 2.2890e-04
Validation cross_entropy = 1.140298
Epoch 32
Loss = 1.0364e+00, PNorm = 37.2164, GNorm = 0.6478, lr_0 = 2.2575e-04
Loss = 1.0378e+00, PNorm = 37.2360, GNorm = 0.7634, lr_0 = 2.2291e-04
Loss = 1.0309e+00, PNorm = 37.2560, GNorm = 0.5130, lr_0 = 2.2012e-04
Loss = 1.0244e+00, PNorm = 37.2757, GNorm = 0.5249, lr_0 = 2.1736e-04
Validation cross_entropy = 1.135651
Epoch 33
Loss = 1.0290e+00, PNorm = 37.2961, GNorm = 0.5315, lr_0 = 2.1436e-04
Loss = 1.0345e+00, PNorm = 37.3138, GNorm = 0.6077, lr_0 = 2.1167e-04
Loss = 1.0376e+00, PNorm = 37.3326, GNorm = 0.7006, lr_0 = 2.0901e-04
Loss = 1.0257e+00, PNorm = 37.3499, GNorm = 0.7655, lr_0 = 2.0639e-04
Validation cross_entropy = 1.134774
Epoch 34
Loss = 1.0234e+00, PNorm = 37.3683, GNorm = 0.4055, lr_0 = 2.0380e-04
Loss = 1.0258e+00, PNorm = 37.3864, GNorm = 0.5292, lr_0 = 2.0125e-04
Loss = 1.0250e+00, PNorm = 37.4042, GNorm = 0.5204, lr_0 = 1.9872e-04
Validation cross_entropy = 1.139323
Epoch 35
Loss = 1.0328e+00, PNorm = 37.4247, GNorm = 0.4015, lr_0 = 1.9598e-04
Loss = 1.0170e+00, PNorm = 37.4437, GNorm = 0.4105, lr_0 = 1.9352e-04
Loss = 1.0291e+00, PNorm = 37.4621, GNorm = 0.5845, lr_0 = 1.9110e-04
Loss = 1.0336e+00, PNorm = 37.4765, GNorm = 0.6019, lr_0 = 1.8870e-04
Validation cross_entropy = 1.147612
Epoch 36
Loss = 1.0330e+00, PNorm = 37.4954, GNorm = 0.4571, lr_0 = 1.8610e-04
Loss = 1.0072e+00, PNorm = 37.5132, GNorm = 0.5593, lr_0 = 1.8376e-04
Loss = 1.0176e+00, PNorm = 37.5327, GNorm = 0.8554, lr_0 = 1.8146e-04
Loss = 1.0222e+00, PNorm = 37.5486, GNorm = 1.0609, lr_0 = 1.7918e-04
Validation cross_entropy = 1.156111
Epoch 37
Loss = 1.0270e+00, PNorm = 37.5620, GNorm = 0.9305, lr_0 = 1.7671e-04
Loss = 1.0081e+00, PNorm = 37.5775, GNorm = 0.6463, lr_0 = 1.7449e-04
Loss = 1.0025e+00, PNorm = 37.5957, GNorm = 0.6267, lr_0 = 1.7230e-04
Loss = 1.0299e+00, PNorm = 37.6116, GNorm = 1.0064, lr_0 = 1.7014e-04
Validation cross_entropy = 1.145851
Epoch 38
Loss = 1.0242e+00, PNorm = 37.6225, GNorm = 0.5291, lr_0 = 1.6801e-04
Loss = 1.0135e+00, PNorm = 37.6384, GNorm = 0.5105, lr_0 = 1.6590e-04
Loss = 1.0062e+00, PNorm = 37.6533, GNorm = 0.6547, lr_0 = 1.6382e-04
Loss = 1.0163e+00, PNorm = 37.6691, GNorm = 0.8338, lr_0 = 1.6176e-04
Validation cross_entropy = 1.149955
Epoch 39
Loss = 1.0066e+00, PNorm = 37.6846, GNorm = 0.5835, lr_0 = 1.5953e-04
Loss = 1.0064e+00, PNorm = 37.6983, GNorm = 0.6474, lr_0 = 1.5753e-04
Loss = 1.0142e+00, PNorm = 37.7127, GNorm = 0.5521, lr_0 = 1.5556e-04
Loss = 1.0042e+00, PNorm = 37.7268, GNorm = 0.6125, lr_0 = 1.5360e-04
Loss = 9.5244e-01, PNorm = 37.7283, GNorm = 1.2823, lr_0 = 1.5341e-04
Validation cross_entropy = 1.148696
Epoch 40
Loss = 9.9971e-01, PNorm = 37.7435, GNorm = 0.5486, lr_0 = 1.5149e-04
Loss = 1.0055e+00, PNorm = 37.7594, GNorm = 1.0345, lr_0 = 1.4959e-04
Loss = 1.0249e+00, PNorm = 37.7723, GNorm = 0.8028, lr_0 = 1.4771e-04
Validation cross_entropy = 1.163666
Epoch 41
Loss = 1.0272e+00, PNorm = 37.7869, GNorm = 0.9520, lr_0 = 1.4567e-04
Loss = 1.0040e+00, PNorm = 37.7990, GNorm = 0.7361, lr_0 = 1.4384e-04
Loss = 1.0083e+00, PNorm = 37.8109, GNorm = 1.1082, lr_0 = 1.4204e-04
Loss = 1.0083e+00, PNorm = 37.8235, GNorm = 0.6824, lr_0 = 1.4026e-04
Validation cross_entropy = 1.154982
Epoch 42
Loss = 1.0093e+00, PNorm = 37.8369, GNorm = 0.7417, lr_0 = 1.3850e-04
Loss = 1.0011e+00, PNorm = 37.8500, GNorm = 0.6507, lr_0 = 1.3676e-04
Loss = 9.9785e-01, PNorm = 37.8626, GNorm = 0.8768, lr_0 = 1.3505e-04
Loss = 1.0154e+00, PNorm = 37.8738, GNorm = 0.6347, lr_0 = 1.3335e-04
Validation cross_entropy = 1.155264
Epoch 43
Loss = 1.0160e+00, PNorm = 37.8857, GNorm = 0.7179, lr_0 = 1.3151e-04
Loss = 9.8949e-01, PNorm = 37.8968, GNorm = 0.7026, lr_0 = 1.2986e-04
Loss = 9.8893e-01, PNorm = 37.9092, GNorm = 0.8558, lr_0 = 1.2823e-04
Loss = 1.0191e+00, PNorm = 37.9202, GNorm = 0.8910, lr_0 = 1.2663e-04
Validation cross_entropy = 1.166552
Epoch 44
Loss = 9.7884e-01, PNorm = 37.9340, GNorm = 0.6526, lr_0 = 1.2488e-04
Loss = 1.0057e+00, PNorm = 37.9454, GNorm = 0.5741, lr_0 = 1.2331e-04
Loss = 9.9368e-01, PNorm = 37.9561, GNorm = 0.9129, lr_0 = 1.2177e-04
Loss = 1.0051e+00, PNorm = 37.9676, GNorm = 0.5946, lr_0 = 1.2024e-04
Validation cross_entropy = 1.178820
Epoch 45
Loss = 1.0202e+00, PNorm = 37.9793, GNorm = 0.6237, lr_0 = 1.1858e-04
Loss = 9.9391e-01, PNorm = 37.9897, GNorm = 0.7386, lr_0 = 1.1709e-04
Loss = 9.8325e-01, PNorm = 38.0010, GNorm = 0.5139, lr_0 = 1.1562e-04
Loss = 9.9385e-01, PNorm = 38.0107, GNorm = 1.4320, lr_0 = 1.1417e-04
Validation cross_entropy = 1.175311
Epoch 46
Loss = 9.8138e-01, PNorm = 38.0208, GNorm = 0.8703, lr_0 = 1.1274e-04
Loss = 9.8825e-01, PNorm = 38.0319, GNorm = 0.7838, lr_0 = 1.1133e-04
Loss = 9.9836e-01, PNorm = 38.0411, GNorm = 1.1987, lr_0 = 1.0993e-04
Validation cross_entropy = 1.160876
Epoch 47
Loss = 1.0157e+00, PNorm = 38.0504, GNorm = 0.6381, lr_0 = 1.0841e-04
Loss = 9.8620e-01, PNorm = 38.0594, GNorm = 0.6457, lr_0 = 1.0705e-04
Loss = 9.9543e-01, PNorm = 38.0682, GNorm = 0.6435, lr_0 = 1.0571e-04
Loss = 9.8845e-01, PNorm = 38.0776, GNorm = 0.6428, lr_0 = 1.0439e-04
Validation cross_entropy = 1.166725
Epoch 48
Loss = 9.9577e-01, PNorm = 38.0878, GNorm = 0.7959, lr_0 = 1.0295e-04
Loss = 9.7671e-01, PNorm = 38.0979, GNorm = 0.9294, lr_0 = 1.0165e-04
Loss = 9.8575e-01, PNorm = 38.1071, GNorm = 0.7384, lr_0 = 1.0038e-04
Loss = 1.0031e+00, PNorm = 38.1158, GNorm = 1.0715, lr_0 = 1.0000e-04
Validation cross_entropy = 1.166161
Epoch 49
Loss = 9.8823e-01, PNorm = 38.1247, GNorm = 0.7737, lr_0 = 1.0000e-04
Loss = 9.9468e-01, PNorm = 38.1326, GNorm = 0.5930, lr_0 = 1.0000e-04
Loss = 9.7454e-01, PNorm = 38.1421, GNorm = 1.4037, lr_0 = 1.0000e-04
Loss = 1.0000e+00, PNorm = 38.1504, GNorm = 0.5756, lr_0 = 1.0000e-04
Validation cross_entropy = 1.186534
Model 1 best validation cross_entropy = 1.093781 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test cross_entropy = 1.105717
Building model 2
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1170e+00, PNorm = 34.0662, GNorm = 0.7634, lr_0 = 2.3026e-04
Loss = 1.1065e+00, PNorm = 34.0668, GNorm = 0.5719, lr_0 = 3.4868e-04
Loss = 1.1033e+00, PNorm = 34.0687, GNorm = 0.6889, lr_0 = 4.6711e-04
Validation cross_entropy = 1.094921
Epoch 1
Loss = 1.1082e+00, PNorm = 34.0727, GNorm = 0.6313, lr_0 = 5.9737e-04
Loss = 1.1006e+00, PNorm = 34.0786, GNorm = 0.5134, lr_0 = 7.1579e-04
Loss = 1.1017e+00, PNorm = 34.0867, GNorm = 0.4417, lr_0 = 8.3421e-04
Loss = 1.1004e+00, PNorm = 34.0977, GNorm = 0.2220, lr_0 = 9.5263e-04
Validation cross_entropy = 1.101364
Epoch 2
Loss = 1.1181e+00, PNorm = 34.1104, GNorm = 0.6755, lr_0 = 9.9120e-04
Loss = 1.1009e+00, PNorm = 34.1271, GNorm = 0.1890, lr_0 = 9.7877e-04
Loss = 1.0989e+00, PNorm = 34.1455, GNorm = 0.3439, lr_0 = 9.6649e-04
Loss = 1.0995e+00, PNorm = 34.1620, GNorm = 0.1752, lr_0 = 9.5437e-04
Validation cross_entropy = 1.096615
Epoch 3
Loss = 1.0948e+00, PNorm = 34.1801, GNorm = 0.1685, lr_0 = 9.4120e-04
Loss = 1.0957e+00, PNorm = 34.1975, GNorm = 0.1633, lr_0 = 9.2940e-04
Loss = 1.0991e+00, PNorm = 34.2134, GNorm = 0.1871, lr_0 = 9.1774e-04
Loss = 1.0958e+00, PNorm = 34.2247, GNorm = 0.1384, lr_0 = 9.0623e-04
Validation cross_entropy = 1.101352
Epoch 4
Loss = 1.0945e+00, PNorm = 34.2387, GNorm = 0.1817, lr_0 = 8.9486e-04
Loss = 1.0937e+00, PNorm = 34.2562, GNorm = 0.2150, lr_0 = 8.8363e-04
Loss = 1.0938e+00, PNorm = 34.2719, GNorm = 0.1516, lr_0 = 8.7255e-04
Loss = 1.0983e+00, PNorm = 34.2860, GNorm = 0.2675, lr_0 = 8.6160e-04
Validation cross_entropy = 1.098984
Epoch 5
Loss = 1.0936e+00, PNorm = 34.3044, GNorm = 0.2477, lr_0 = 8.4972e-04
Loss = 1.0917e+00, PNorm = 34.3300, GNorm = 0.3458, lr_0 = 8.3906e-04
Loss = 1.0933e+00, PNorm = 34.3500, GNorm = 0.3582, lr_0 = 8.2854e-04
Validation cross_entropy = 1.096291
Epoch 6
Loss = 1.0945e+00, PNorm = 34.3676, GNorm = 0.0939, lr_0 = 8.1711e-04
Loss = 1.0939e+00, PNorm = 34.3861, GNorm = 0.2279, lr_0 = 8.0686e-04
Loss = 1.0905e+00, PNorm = 34.4086, GNorm = 0.2209, lr_0 = 7.9674e-04
Loss = 1.0934e+00, PNorm = 34.4274, GNorm = 0.1281, lr_0 = 7.8674e-04
Validation cross_entropy = 1.096224
Epoch 7
Loss = 1.0890e+00, PNorm = 34.4565, GNorm = 0.1269, lr_0 = 7.7589e-04
Loss = 1.0916e+00, PNorm = 34.4884, GNorm = 0.2111, lr_0 = 7.6616e-04
Loss = 1.0924e+00, PNorm = 34.5131, GNorm = 0.2378, lr_0 = 7.5655e-04
Loss = 1.0883e+00, PNorm = 34.5384, GNorm = 0.1780, lr_0 = 7.4706e-04
Validation cross_entropy = 1.094485
Epoch 8
Loss = 1.0960e+00, PNorm = 34.5626, GNorm = 0.2301, lr_0 = 7.3769e-04
Loss = 1.0832e+00, PNorm = 34.5898, GNorm = 0.1219, lr_0 = 7.2843e-04
Loss = 1.0885e+00, PNorm = 34.6243, GNorm = 0.2506, lr_0 = 7.1930e-04
Loss = 1.0983e+00, PNorm = 34.6422, GNorm = 0.2731, lr_0 = 7.1027e-04
Validation cross_entropy = 1.096239
Epoch 9
Loss = 1.0921e+00, PNorm = 34.6752, GNorm = 0.1016, lr_0 = 7.0048e-04
Loss = 1.0921e+00, PNorm = 34.7052, GNorm = 0.1399, lr_0 = 6.9169e-04
Loss = 1.0959e+00, PNorm = 34.7291, GNorm = 0.1041, lr_0 = 6.8301e-04
Loss = 1.0915e+00, PNorm = 34.7538, GNorm = 0.2403, lr_0 = 6.7445e-04
Validation cross_entropy = 1.099562
Epoch 10
Loss = 1.0884e+00, PNorm = 34.7902, GNorm = 0.2397, lr_0 = 6.6515e-04
Loss = 1.0817e+00, PNorm = 34.8317, GNorm = 0.1743, lr_0 = 6.5680e-04
Loss = 1.0885e+00, PNorm = 34.8619, GNorm = 0.1382, lr_0 = 6.4856e-04
Loss = 1.0916e+00, PNorm = 34.8880, GNorm = 0.1469, lr_0 = 6.4043e-04
Loss = 1.0525e+00, PNorm = 34.8904, GNorm = 0.3597, lr_0 = 6.3962e-04
Validation cross_entropy = 1.095624
Epoch 11
Loss = 1.0905e+00, PNorm = 34.9152, GNorm = 0.1983, lr_0 = 6.3159e-04
Loss = 1.0912e+00, PNorm = 34.9475, GNorm = 0.3040, lr_0 = 6.2367e-04
Loss = 1.0815e+00, PNorm = 34.9805, GNorm = 0.2222, lr_0 = 6.1585e-04
Validation cross_entropy = 1.107410
Epoch 12
Loss = 1.0699e+00, PNorm = 35.0125, GNorm = 0.1958, lr_0 = 6.0812e-04
Loss = 1.0820e+00, PNorm = 35.0512, GNorm = 0.1879, lr_0 = 6.0049e-04
Loss = 1.0853e+00, PNorm = 35.0879, GNorm = 0.1712, lr_0 = 5.9296e-04
Loss = 1.0830e+00, PNorm = 35.1237, GNorm = 0.2242, lr_0 = 5.8552e-04
Validation cross_entropy = 1.108747
Epoch 13
Loss = 1.0916e+00, PNorm = 35.1615, GNorm = 0.1571, lr_0 = 5.7745e-04
Loss = 1.0780e+00, PNorm = 35.2006, GNorm = 0.1555, lr_0 = 5.7020e-04
Loss = 1.0882e+00, PNorm = 35.2368, GNorm = 0.3279, lr_0 = 5.6305e-04
Loss = 1.0784e+00, PNorm = 35.2667, GNorm = 0.2197, lr_0 = 5.5599e-04
Validation cross_entropy = 1.100052
Epoch 14
Loss = 1.0787e+00, PNorm = 35.3087, GNorm = 0.2476, lr_0 = 5.4832e-04
Loss = 1.0768e+00, PNorm = 35.3447, GNorm = 0.2209, lr_0 = 5.4144e-04
Loss = 1.0778e+00, PNorm = 35.3895, GNorm = 0.1591, lr_0 = 5.3465e-04
Loss = 1.0862e+00, PNorm = 35.4218, GNorm = 0.2897, lr_0 = 5.2794e-04
Validation cross_entropy = 1.103496
Epoch 15
Loss = 1.0747e+00, PNorm = 35.4520, GNorm = 0.1960, lr_0 = 5.2066e-04
Loss = 1.0717e+00, PNorm = 35.4894, GNorm = 0.2014, lr_0 = 5.1413e-04
Loss = 1.0772e+00, PNorm = 35.5252, GNorm = 0.4459, lr_0 = 5.0768e-04
Loss = 1.0780e+00, PNorm = 35.5561, GNorm = 0.2625, lr_0 = 5.0131e-04
Validation cross_entropy = 1.112053
Epoch 16
Loss = 1.0729e+00, PNorm = 35.5922, GNorm = 0.1881, lr_0 = 4.9503e-04
Loss = 1.0703e+00, PNorm = 35.6328, GNorm = 0.2265, lr_0 = 4.8882e-04
Loss = 1.0808e+00, PNorm = 35.6652, GNorm = 0.2098, lr_0 = 4.8268e-04
Loss = 1.0718e+00, PNorm = 35.6994, GNorm = 0.2419, lr_0 = 4.7663e-04
Loss = 1.0638e+00, PNorm = 35.7032, GNorm = 0.5415, lr_0 = 4.7603e-04
Validation cross_entropy = 1.107171
Epoch 17
Loss = 1.0598e+00, PNorm = 35.7438, GNorm = 0.3495, lr_0 = 4.7006e-04
Loss = 1.0732e+00, PNorm = 35.7860, GNorm = 0.1943, lr_0 = 4.6416e-04
Loss = 1.0713e+00, PNorm = 35.8244, GNorm = 0.4082, lr_0 = 4.5834e-04
Validation cross_entropy = 1.111584
Epoch 18
Loss = 1.0548e+00, PNorm = 35.8666, GNorm = 0.1813, lr_0 = 4.5202e-04
Loss = 1.0634e+00, PNorm = 35.9167, GNorm = 0.3491, lr_0 = 4.4635e-04
Loss = 1.0755e+00, PNorm = 35.9515, GNorm = 0.2413, lr_0 = 4.4075e-04
Loss = 1.0640e+00, PNorm = 35.9857, GNorm = 0.2248, lr_0 = 4.3522e-04
Validation cross_entropy = 1.117516
Epoch 19
Loss = 1.0794e+00, PNorm = 36.0146, GNorm = 0.3309, lr_0 = 4.2976e-04
Loss = 1.0557e+00, PNorm = 36.0473, GNorm = 0.2797, lr_0 = 4.2437e-04
Loss = 1.0633e+00, PNorm = 36.0822, GNorm = 0.3436, lr_0 = 4.1904e-04
Loss = 1.0650e+00, PNorm = 36.1161, GNorm = 0.2982, lr_0 = 4.1379e-04
Validation cross_entropy = 1.121765
Epoch 20
Loss = 1.0532e+00, PNorm = 36.1510, GNorm = 0.6528, lr_0 = 4.0808e-04
Loss = 1.0681e+00, PNorm = 36.1824, GNorm = 0.4675, lr_0 = 4.0296e-04
Loss = 1.0586e+00, PNorm = 36.2174, GNorm = 0.3430, lr_0 = 3.9791e-04
Loss = 1.0533e+00, PNorm = 36.2545, GNorm = 0.2463, lr_0 = 3.9291e-04
Validation cross_entropy = 1.121513
Epoch 21
Loss = 1.0691e+00, PNorm = 36.2944, GNorm = 0.3316, lr_0 = 3.8750e-04
Loss = 1.0625e+00, PNorm = 36.3310, GNorm = 0.5301, lr_0 = 3.8264e-04
Loss = 1.0590e+00, PNorm = 36.3585, GNorm = 0.4129, lr_0 = 3.7784e-04
Loss = 1.0566e+00, PNorm = 36.3916, GNorm = 0.2295, lr_0 = 3.7310e-04
Validation cross_entropy = 1.108919
Epoch 22
Loss = 1.0626e+00, PNorm = 36.4240, GNorm = 0.3821, lr_0 = 3.6795e-04
Loss = 1.0559e+00, PNorm = 36.4573, GNorm = 0.5907, lr_0 = 3.6333e-04
Loss = 1.0509e+00, PNorm = 36.4928, GNorm = 0.3394, lr_0 = 3.5878e-04
Loss = 1.0748e+00, PNorm = 36.5228, GNorm = 0.7192, lr_0 = 3.5428e-04
Validation cross_entropy = 1.122993
Epoch 23
Loss = 1.0578e+00, PNorm = 36.5488, GNorm = 0.2260, lr_0 = 3.4983e-04
Loss = 1.0684e+00, PNorm = 36.5758, GNorm = 0.2630, lr_0 = 3.4544e-04
Loss = 1.0547e+00, PNorm = 36.6065, GNorm = 0.4217, lr_0 = 3.4111e-04
Validation cross_entropy = 1.125439
Epoch 24
Loss = 1.0350e+00, PNorm = 36.6409, GNorm = 0.2802, lr_0 = 3.3641e-04
Loss = 1.0536e+00, PNorm = 36.6703, GNorm = 0.2529, lr_0 = 3.3219e-04
Loss = 1.0461e+00, PNorm = 36.7006, GNorm = 0.3334, lr_0 = 3.2802e-04
Loss = 1.0580e+00, PNorm = 36.7248, GNorm = 0.2698, lr_0 = 3.2390e-04
Validation cross_entropy = 1.124546
Epoch 25
Loss = 1.0502e+00, PNorm = 36.7543, GNorm = 0.3002, lr_0 = 3.1944e-04
Loss = 1.0541e+00, PNorm = 36.7802, GNorm = 0.4633, lr_0 = 3.1543e-04
Loss = 1.0553e+00, PNorm = 36.8046, GNorm = 0.3781, lr_0 = 3.1147e-04
Loss = 1.0493e+00, PNorm = 36.8296, GNorm = 0.4485, lr_0 = 3.0757e-04
Validation cross_entropy = 1.121916
Epoch 26
Loss = 1.0532e+00, PNorm = 36.8614, GNorm = 0.3669, lr_0 = 3.0332e-04
Loss = 1.0421e+00, PNorm = 36.8916, GNorm = 0.5312, lr_0 = 2.9952e-04
Loss = 1.0374e+00, PNorm = 36.9229, GNorm = 0.5189, lr_0 = 2.9576e-04
Loss = 1.0519e+00, PNorm = 36.9470, GNorm = 0.3629, lr_0 = 2.9205e-04
Validation cross_entropy = 1.133554
Epoch 27
Loss = 1.0404e+00, PNorm = 36.9711, GNorm = 0.4707, lr_0 = 2.8839e-04
Loss = 1.0355e+00, PNorm = 37.0004, GNorm = 0.3317, lr_0 = 2.8477e-04
Loss = 1.0363e+00, PNorm = 37.0243, GNorm = 0.5986, lr_0 = 2.8120e-04
Loss = 1.0493e+00, PNorm = 37.0483, GNorm = 0.4403, lr_0 = 2.7767e-04
Validation cross_entropy = 1.127782
Epoch 28
Loss = 1.0312e+00, PNorm = 37.0752, GNorm = 0.3650, lr_0 = 2.7384e-04
Loss = 1.0253e+00, PNorm = 37.1037, GNorm = 0.4065, lr_0 = 2.7041e-04
Loss = 1.0382e+00, PNorm = 37.1281, GNorm = 0.5652, lr_0 = 2.6701e-04
Validation cross_entropy = 1.131443
Epoch 29
Loss = 1.0078e+00, PNorm = 37.1515, GNorm = 0.4947, lr_0 = 2.6333e-04
Loss = 1.0344e+00, PNorm = 37.1772, GNorm = 0.5568, lr_0 = 2.6003e-04
Loss = 1.0240e+00, PNorm = 37.2039, GNorm = 0.6090, lr_0 = 2.5677e-04
Loss = 1.0257e+00, PNorm = 37.2280, GNorm = 0.3919, lr_0 = 2.5355e-04
Validation cross_entropy = 1.139672
Epoch 30
Loss = 1.0216e+00, PNorm = 37.2544, GNorm = 0.4500, lr_0 = 2.5005e-04
Loss = 1.0205e+00, PNorm = 37.2795, GNorm = 0.4754, lr_0 = 2.4691e-04
Loss = 1.0261e+00, PNorm = 37.3044, GNorm = 0.6314, lr_0 = 2.4382e-04
Loss = 1.0327e+00, PNorm = 37.3287, GNorm = 0.6378, lr_0 = 2.4076e-04
Validation cross_entropy = 1.150033
Epoch 31
Loss = 1.0334e+00, PNorm = 37.3507, GNorm = 0.5854, lr_0 = 2.3774e-04
Loss = 1.0295e+00, PNorm = 37.3724, GNorm = 0.7836, lr_0 = 2.3475e-04
Loss = 1.0215e+00, PNorm = 37.3956, GNorm = 0.4684, lr_0 = 2.3181e-04
Loss = 1.0172e+00, PNorm = 37.4197, GNorm = 0.8729, lr_0 = 2.2890e-04
Validation cross_entropy = 1.139806
Epoch 32
Loss = 1.0232e+00, PNorm = 37.4417, GNorm = 0.7495, lr_0 = 2.2575e-04
Loss = 1.0227e+00, PNorm = 37.4640, GNorm = 0.4280, lr_0 = 2.2291e-04
Loss = 1.0122e+00, PNorm = 37.4862, GNorm = 0.4690, lr_0 = 2.2012e-04
Loss = 1.0227e+00, PNorm = 37.5106, GNorm = 0.5363, lr_0 = 2.1736e-04
Validation cross_entropy = 1.149641
Epoch 33
Loss = 1.0004e+00, PNorm = 37.5310, GNorm = 0.5451, lr_0 = 2.1436e-04
Loss = 1.0142e+00, PNorm = 37.5520, GNorm = 0.8086, lr_0 = 2.1167e-04
Loss = 1.0278e+00, PNorm = 37.5723, GNorm = 0.6592, lr_0 = 2.0901e-04
Loss = 1.0367e+00, PNorm = 37.5911, GNorm = 0.8893, lr_0 = 2.0639e-04
Validation cross_entropy = 1.145196
Epoch 34
Loss = 1.0166e+00, PNorm = 37.6081, GNorm = 0.6127, lr_0 = 2.0380e-04
Loss = 1.0089e+00, PNorm = 37.6285, GNorm = 0.9190, lr_0 = 2.0125e-04
Loss = 1.0244e+00, PNorm = 37.6470, GNorm = 0.5764, lr_0 = 1.9872e-04
Validation cross_entropy = 1.153658
Epoch 35
Loss = 9.7621e-01, PNorm = 37.6675, GNorm = 0.5755, lr_0 = 1.9598e-04
Loss = 1.0130e+00, PNorm = 37.6870, GNorm = 0.8888, lr_0 = 1.9352e-04
Loss = 1.0193e+00, PNorm = 37.7060, GNorm = 1.0671, lr_0 = 1.9110e-04
Loss = 1.0240e+00, PNorm = 37.7224, GNorm = 0.8547, lr_0 = 1.8870e-04
Validation cross_entropy = 1.154152
Epoch 36
Loss = 1.0123e+00, PNorm = 37.7397, GNorm = 0.7045, lr_0 = 1.8610e-04
Loss = 1.0151e+00, PNorm = 37.7578, GNorm = 0.7099, lr_0 = 1.8376e-04
Loss = 1.0112e+00, PNorm = 37.7742, GNorm = 0.6961, lr_0 = 1.8146e-04
Loss = 1.0063e+00, PNorm = 37.7924, GNorm = 0.6096, lr_0 = 1.7918e-04
Validation cross_entropy = 1.157548
Epoch 37
Loss = 9.7525e-01, PNorm = 37.8119, GNorm = 0.4764, lr_0 = 1.7671e-04
Loss = 1.0216e+00, PNorm = 37.8291, GNorm = 0.7958, lr_0 = 1.7449e-04
Loss = 1.0043e+00, PNorm = 37.8435, GNorm = 0.8241, lr_0 = 1.7230e-04
Loss = 1.0168e+00, PNorm = 37.8595, GNorm = 0.8579, lr_0 = 1.7014e-04
Validation cross_entropy = 1.165329
Epoch 38
Loss = 1.0112e+00, PNorm = 37.8760, GNorm = 0.5684, lr_0 = 1.6801e-04
Loss = 9.9338e-01, PNorm = 37.8925, GNorm = 1.0006, lr_0 = 1.6590e-04
Loss = 9.9991e-01, PNorm = 37.9086, GNorm = 0.5202, lr_0 = 1.6382e-04
Loss = 9.9555e-01, PNorm = 37.9257, GNorm = 0.6742, lr_0 = 1.6176e-04
Validation cross_entropy = 1.173023
Epoch 39
Loss = 9.8333e-01, PNorm = 37.9425, GNorm = 0.6318, lr_0 = 1.5953e-04
Loss = 9.9623e-01, PNorm = 37.9575, GNorm = 0.6119, lr_0 = 1.5753e-04
Loss = 1.0186e+00, PNorm = 37.9725, GNorm = 0.8382, lr_0 = 1.5556e-04
Loss = 9.9333e-01, PNorm = 37.9869, GNorm = 0.6492, lr_0 = 1.5360e-04
Loss = 1.0020e+00, PNorm = 37.9884, GNorm = 1.4897, lr_0 = 1.5341e-04
Validation cross_entropy = 1.174331
Epoch 40
Loss = 9.9635e-01, PNorm = 38.0028, GNorm = 0.5046, lr_0 = 1.5149e-04
Loss = 9.8531e-01, PNorm = 38.0186, GNorm = 0.6274, lr_0 = 1.4959e-04
Loss = 9.9721e-01, PNorm = 38.0330, GNorm = 0.7024, lr_0 = 1.4771e-04
Validation cross_entropy = 1.182514
Epoch 41
Loss = 9.6039e-01, PNorm = 38.0469, GNorm = 0.7490, lr_0 = 1.4567e-04
Loss = 9.9260e-01, PNorm = 38.0596, GNorm = 0.9931, lr_0 = 1.4384e-04
Loss = 9.8199e-01, PNorm = 38.0729, GNorm = 0.7195, lr_0 = 1.4204e-04
Loss = 1.0015e+00, PNorm = 38.0876, GNorm = 0.9886, lr_0 = 1.4026e-04
Validation cross_entropy = 1.182937
Epoch 42
Loss = 1.0047e+00, PNorm = 38.0998, GNorm = 0.6813, lr_0 = 1.3850e-04
Loss = 9.6858e-01, PNorm = 38.1141, GNorm = 0.7150, lr_0 = 1.3676e-04
Loss = 9.9804e-01, PNorm = 38.1268, GNorm = 0.7317, lr_0 = 1.3505e-04
Loss = 9.8816e-01, PNorm = 38.1393, GNorm = 1.1628, lr_0 = 1.3335e-04
Validation cross_entropy = 1.172534
Epoch 43
Loss = 1.0004e+00, PNorm = 38.1510, GNorm = 0.9354, lr_0 = 1.3151e-04
Loss = 9.7319e-01, PNorm = 38.1634, GNorm = 0.5379, lr_0 = 1.2986e-04
Loss = 9.9534e-01, PNorm = 38.1753, GNorm = 0.8384, lr_0 = 1.2823e-04
Loss = 9.9477e-01, PNorm = 38.1860, GNorm = 0.8581, lr_0 = 1.2663e-04
Validation cross_entropy = 1.183989
Epoch 44
Loss = 9.9206e-01, PNorm = 38.1981, GNorm = 0.7151, lr_0 = 1.2488e-04
Loss = 9.8006e-01, PNorm = 38.2085, GNorm = 0.5963, lr_0 = 1.2331e-04
Loss = 9.8590e-01, PNorm = 38.2195, GNorm = 0.8536, lr_0 = 1.2177e-04
Loss = 9.8887e-01, PNorm = 38.2311, GNorm = 0.9257, lr_0 = 1.2024e-04
Validation cross_entropy = 1.178686
Epoch 45
Loss = 9.8002e-01, PNorm = 38.2443, GNorm = 0.9851, lr_0 = 1.1858e-04
Loss = 9.7469e-01, PNorm = 38.2557, GNorm = 0.7831, lr_0 = 1.1709e-04
Loss = 9.8655e-01, PNorm = 38.2664, GNorm = 0.8719, lr_0 = 1.1562e-04
Loss = 9.8343e-01, PNorm = 38.2756, GNorm = 1.4303, lr_0 = 1.1417e-04
Validation cross_entropy = 1.189591
Epoch 46
Loss = 9.7961e-01, PNorm = 38.2854, GNorm = 0.8149, lr_0 = 1.1274e-04
Loss = 9.7860e-01, PNorm = 38.2954, GNorm = 0.6090, lr_0 = 1.1133e-04
Loss = 9.8332e-01, PNorm = 38.3058, GNorm = 0.7250, lr_0 = 1.0993e-04
Validation cross_entropy = 1.194598
Epoch 47
Loss = 9.9115e-01, PNorm = 38.3166, GNorm = 1.1295, lr_0 = 1.0841e-04
Loss = 9.8049e-01, PNorm = 38.3267, GNorm = 0.7847, lr_0 = 1.0705e-04
Loss = 9.8354e-01, PNorm = 38.3351, GNorm = 0.8391, lr_0 = 1.0571e-04
Loss = 9.6977e-01, PNorm = 38.3455, GNorm = 0.7431, lr_0 = 1.0439e-04
Validation cross_entropy = 1.184186
Epoch 48
Loss = 9.9452e-01, PNorm = 38.3555, GNorm = 0.6880, lr_0 = 1.0295e-04
Loss = 9.7298e-01, PNorm = 38.3642, GNorm = 1.0186, lr_0 = 1.0165e-04
Loss = 9.7601e-01, PNorm = 38.3723, GNorm = 0.6180, lr_0 = 1.0038e-04
Loss = 9.8422e-01, PNorm = 38.3810, GNorm = 1.3143, lr_0 = 1.0000e-04
Validation cross_entropy = 1.187423
Epoch 49
Loss = 9.6695e-01, PNorm = 38.3896, GNorm = 0.8569, lr_0 = 1.0000e-04
Loss = 9.7907e-01, PNorm = 38.3986, GNorm = 0.7003, lr_0 = 1.0000e-04
Loss = 9.8185e-01, PNorm = 38.4057, GNorm = 0.7731, lr_0 = 1.0000e-04
Loss = 9.7578e-01, PNorm = 38.4142, GNorm = 1.0723, lr_0 = 1.0000e-04
Validation cross_entropy = 1.182432
Model 2 best validation cross_entropy = 1.094485 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 2 test cross_entropy = 1.101165
Building model 3
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1297e+00, PNorm = 34.0400, GNorm = 0.7823, lr_0 = 2.3026e-04
Loss = 1.1025e+00, PNorm = 34.0403, GNorm = 0.4889, lr_0 = 3.4868e-04
Loss = 1.1073e+00, PNorm = 34.0426, GNorm = 0.5424, lr_0 = 4.6711e-04
Validation cross_entropy = 1.098074
Epoch 1
Loss = 1.1270e+00, PNorm = 34.0453, GNorm = 0.7848, lr_0 = 5.9737e-04
Loss = 1.1013e+00, PNorm = 34.0504, GNorm = 0.4455, lr_0 = 7.1579e-04
Loss = 1.1052e+00, PNorm = 34.0584, GNorm = 0.3603, lr_0 = 8.3421e-04
Loss = 1.0981e+00, PNorm = 34.0710, GNorm = 0.1768, lr_0 = 9.5263e-04
Validation cross_entropy = 1.112832
Epoch 2
Loss = 1.1018e+00, PNorm = 34.0879, GNorm = 0.2817, lr_0 = 9.9120e-04
Loss = 1.0963e+00, PNorm = 34.1041, GNorm = 0.1702, lr_0 = 9.7877e-04
Loss = 1.0964e+00, PNorm = 34.1199, GNorm = 0.1753, lr_0 = 9.6649e-04
Loss = 1.1002e+00, PNorm = 34.1327, GNorm = 0.2067, lr_0 = 9.5437e-04
Validation cross_entropy = 1.098341
Epoch 3
Loss = 1.0985e+00, PNorm = 34.1473, GNorm = 0.1870, lr_0 = 9.4120e-04
Loss = 1.0961e+00, PNorm = 34.1589, GNorm = 0.1168, lr_0 = 9.2940e-04
Loss = 1.0987e+00, PNorm = 34.1698, GNorm = 0.1206, lr_0 = 9.1774e-04
Loss = 1.0993e+00, PNorm = 34.1794, GNorm = 0.1698, lr_0 = 9.0623e-04
Validation cross_entropy = 1.097044
Epoch 4
Loss = 1.0940e+00, PNorm = 34.1899, GNorm = 0.1157, lr_0 = 8.9486e-04
Loss = 1.1005e+00, PNorm = 34.2022, GNorm = 0.1613, lr_0 = 8.8363e-04
Loss = 1.0956e+00, PNorm = 34.2153, GNorm = 0.1410, lr_0 = 8.7255e-04
Loss = 1.0984e+00, PNorm = 34.2279, GNorm = 0.1472, lr_0 = 8.6160e-04
Validation cross_entropy = 1.097556
Epoch 5
Loss = 1.0948e+00, PNorm = 34.2408, GNorm = 0.1620, lr_0 = 8.4972e-04
Loss = 1.0948e+00, PNorm = 34.2561, GNorm = 0.1465, lr_0 = 8.3906e-04
Loss = 1.0938e+00, PNorm = 34.2727, GNorm = 0.1077, lr_0 = 8.2854e-04
Validation cross_entropy = 1.098886
Epoch 6
Loss = 1.0906e+00, PNorm = 34.2899, GNorm = 0.1471, lr_0 = 8.1711e-04
Loss = 1.0987e+00, PNorm = 34.3043, GNorm = 0.1086, lr_0 = 8.0686e-04
Loss = 1.0953e+00, PNorm = 34.3202, GNorm = 0.1130, lr_0 = 7.9674e-04
Loss = 1.0909e+00, PNorm = 34.3403, GNorm = 0.1533, lr_0 = 7.8674e-04
Validation cross_entropy = 1.101063
Epoch 7
Loss = 1.0935e+00, PNorm = 34.3659, GNorm = 0.1231, lr_0 = 7.7589e-04
Loss = 1.0952e+00, PNorm = 34.3903, GNorm = 0.1137, lr_0 = 7.6616e-04
Loss = 1.0918e+00, PNorm = 34.4145, GNorm = 0.1907, lr_0 = 7.5655e-04
Loss = 1.0907e+00, PNorm = 34.4381, GNorm = 0.2043, lr_0 = 7.4706e-04
Validation cross_entropy = 1.099644
Epoch 8
Loss = 1.0970e+00, PNorm = 34.4590, GNorm = 0.1997, lr_0 = 7.3769e-04
Loss = 1.0843e+00, PNorm = 34.4852, GNorm = 0.1840, lr_0 = 7.2843e-04
Loss = 1.0961e+00, PNorm = 34.5167, GNorm = 0.1765, lr_0 = 7.1930e-04
Loss = 1.0916e+00, PNorm = 34.5419, GNorm = 0.1696, lr_0 = 7.1027e-04
Validation cross_entropy = 1.097553
Epoch 9
Loss = 1.0914e+00, PNorm = 34.5712, GNorm = 0.3579, lr_0 = 7.0048e-04
Loss = 1.0903e+00, PNorm = 34.6017, GNorm = 0.2056, lr_0 = 6.9169e-04
Loss = 1.0958e+00, PNorm = 34.6324, GNorm = 0.5380, lr_0 = 6.8301e-04
Loss = 1.0897e+00, PNorm = 34.6621, GNorm = 0.1535, lr_0 = 6.7445e-04
Validation cross_entropy = 1.103994
Epoch 10
Loss = 1.0901e+00, PNorm = 34.6956, GNorm = 0.1222, lr_0 = 6.6515e-04
Loss = 1.0853e+00, PNorm = 34.7260, GNorm = 0.1381, lr_0 = 6.5680e-04
Loss = 1.0878e+00, PNorm = 34.7599, GNorm = 0.3429, lr_0 = 6.4856e-04
Loss = 1.0875e+00, PNorm = 34.7963, GNorm = 0.2661, lr_0 = 6.4043e-04
Loss = 1.1147e+00, PNorm = 34.7981, GNorm = 0.6914, lr_0 = 6.3962e-04
Validation cross_entropy = 1.102207
Epoch 11
Loss = 1.0881e+00, PNorm = 34.8245, GNorm = 0.1894, lr_0 = 6.3159e-04
Loss = 1.0864e+00, PNorm = 34.8575, GNorm = 0.2427, lr_0 = 6.2367e-04
Loss = 1.0816e+00, PNorm = 34.8870, GNorm = 0.1555, lr_0 = 6.1585e-04
Validation cross_entropy = 1.102143
Epoch 12
Loss = 1.0756e+00, PNorm = 34.9217, GNorm = 0.2551, lr_0 = 6.0812e-04
Loss = 1.0797e+00, PNorm = 34.9614, GNorm = 0.2324, lr_0 = 6.0049e-04
Loss = 1.0924e+00, PNorm = 34.9995, GNorm = 0.3419, lr_0 = 5.9296e-04
Loss = 1.0870e+00, PNorm = 35.0220, GNorm = 0.1379, lr_0 = 5.8552e-04
Validation cross_entropy = 1.100373
Epoch 13
Loss = 1.0789e+00, PNorm = 35.0520, GNorm = 0.1447, lr_0 = 5.7745e-04
Loss = 1.0808e+00, PNorm = 35.0840, GNorm = 0.4377, lr_0 = 5.7020e-04
Loss = 1.0847e+00, PNorm = 35.1156, GNorm = 0.1999, lr_0 = 5.6305e-04
Loss = 1.0853e+00, PNorm = 35.1470, GNorm = 0.3227, lr_0 = 5.5599e-04
Validation cross_entropy = 1.099377
Epoch 14
Loss = 1.0927e+00, PNorm = 35.1727, GNorm = 0.2189, lr_0 = 5.4832e-04
Loss = 1.0770e+00, PNorm = 35.2009, GNorm = 0.2075, lr_0 = 5.4144e-04
Loss = 1.0836e+00, PNorm = 35.2279, GNorm = 0.1911, lr_0 = 5.3465e-04
Loss = 1.0805e+00, PNorm = 35.2600, GNorm = 0.1346, lr_0 = 5.2794e-04
Validation cross_entropy = 1.100147
Epoch 15
Loss = 1.0851e+00, PNorm = 35.2949, GNorm = 0.1946, lr_0 = 5.2066e-04
Loss = 1.0693e+00, PNorm = 35.3295, GNorm = 0.2235, lr_0 = 5.1413e-04
Loss = 1.0877e+00, PNorm = 35.3593, GNorm = 0.4835, lr_0 = 5.0768e-04
Loss = 1.0837e+00, PNorm = 35.3830, GNorm = 0.2257, lr_0 = 5.0131e-04
Validation cross_entropy = 1.105830
Epoch 16
Loss = 1.0765e+00, PNorm = 35.4114, GNorm = 0.1869, lr_0 = 4.9503e-04
Loss = 1.0753e+00, PNorm = 35.4453, GNorm = 0.2486, lr_0 = 4.8882e-04
Loss = 1.0817e+00, PNorm = 35.4768, GNorm = 0.2235, lr_0 = 4.8268e-04
Loss = 1.0840e+00, PNorm = 35.5021, GNorm = 0.3448, lr_0 = 4.7663e-04
Loss = 1.0502e+00, PNorm = 35.5050, GNorm = 0.4754, lr_0 = 4.7603e-04
Validation cross_entropy = 1.113453
Epoch 17
Loss = 1.0768e+00, PNorm = 35.5320, GNorm = 0.1536, lr_0 = 4.7006e-04
Loss = 1.0750e+00, PNorm = 35.5638, GNorm = 0.5333, lr_0 = 4.6416e-04
Loss = 1.0753e+00, PNorm = 35.5997, GNorm = 0.2706, lr_0 = 4.5834e-04
Validation cross_entropy = 1.105641
Epoch 18
Loss = 1.0786e+00, PNorm = 35.6280, GNorm = 0.2142, lr_0 = 4.5202e-04
Loss = 1.0778e+00, PNorm = 35.6574, GNorm = 0.2837, lr_0 = 4.4635e-04
Loss = 1.0668e+00, PNorm = 35.6866, GNorm = 0.2127, lr_0 = 4.4075e-04
Loss = 1.0784e+00, PNorm = 35.7188, GNorm = 0.2388, lr_0 = 4.3522e-04
Validation cross_entropy = 1.112043
Epoch 19
Loss = 1.0692e+00, PNorm = 35.7489, GNorm = 0.3950, lr_0 = 4.2976e-04
Loss = 1.0801e+00, PNorm = 35.7845, GNorm = 0.2919, lr_0 = 4.2437e-04
Loss = 1.0757e+00, PNorm = 35.8144, GNorm = 0.1665, lr_0 = 4.1904e-04
Loss = 1.0683e+00, PNorm = 35.8425, GNorm = 0.2317, lr_0 = 4.1379e-04
Validation cross_entropy = 1.118094
Epoch 20
Loss = 1.0687e+00, PNorm = 35.8805, GNorm = 0.7234, lr_0 = 4.0808e-04
Loss = 1.0764e+00, PNorm = 35.9065, GNorm = 0.3540, lr_0 = 4.0296e-04
Loss = 1.0694e+00, PNorm = 35.9341, GNorm = 0.1609, lr_0 = 3.9791e-04
Loss = 1.0733e+00, PNorm = 35.9618, GNorm = 0.3717, lr_0 = 3.9291e-04
Validation cross_entropy = 1.122614
Epoch 21
Loss = 1.0668e+00, PNorm = 35.9960, GNorm = 0.3178, lr_0 = 3.8750e-04
Loss = 1.0724e+00, PNorm = 36.0266, GNorm = 0.6098, lr_0 = 3.8264e-04
Loss = 1.0715e+00, PNorm = 36.0522, GNorm = 0.1991, lr_0 = 3.7784e-04
Loss = 1.0732e+00, PNorm = 36.0781, GNorm = 0.2365, lr_0 = 3.7310e-04
Validation cross_entropy = 1.107552
Epoch 22
Loss = 1.0608e+00, PNorm = 36.1136, GNorm = 0.2728, lr_0 = 3.6795e-04
Loss = 1.0660e+00, PNorm = 36.1432, GNorm = 0.1943, lr_0 = 3.6333e-04
Loss = 1.0688e+00, PNorm = 36.1725, GNorm = 0.3832, lr_0 = 3.5878e-04
Loss = 1.0655e+00, PNorm = 36.1971, GNorm = 0.5220, lr_0 = 3.5428e-04
Validation cross_entropy = 1.116808
Epoch 23
Loss = 1.0654e+00, PNorm = 36.2249, GNorm = 0.3169, lr_0 = 3.4983e-04
Loss = 1.0610e+00, PNorm = 36.2530, GNorm = 0.2121, lr_0 = 3.4544e-04
Loss = 1.0633e+00, PNorm = 36.2845, GNorm = 0.2848, lr_0 = 3.4111e-04
Validation cross_entropy = 1.125783
Epoch 24
Loss = 1.0346e+00, PNorm = 36.3179, GNorm = 0.4545, lr_0 = 3.3641e-04
Loss = 1.0605e+00, PNorm = 36.3428, GNorm = 0.3484, lr_0 = 3.3219e-04
Loss = 1.0634e+00, PNorm = 36.3724, GNorm = 0.5217, lr_0 = 3.2802e-04
Loss = 1.0466e+00, PNorm = 36.3988, GNorm = 0.2620, lr_0 = 3.2390e-04
Validation cross_entropy = 1.129765
Epoch 25
Loss = 1.0510e+00, PNorm = 36.4305, GNorm = 0.3256, lr_0 = 3.1944e-04
Loss = 1.0661e+00, PNorm = 36.4516, GNorm = 0.3082, lr_0 = 3.1543e-04
Loss = 1.0647e+00, PNorm = 36.4790, GNorm = 0.3243, lr_0 = 3.1147e-04
Loss = 1.0551e+00, PNorm = 36.5071, GNorm = 0.2536, lr_0 = 3.0757e-04
Validation cross_entropy = 1.130865
Epoch 26
Loss = 1.0527e+00, PNorm = 36.5393, GNorm = 0.3929, lr_0 = 3.0332e-04
Loss = 1.0514e+00, PNorm = 36.5710, GNorm = 0.3484, lr_0 = 2.9952e-04
Loss = 1.0534e+00, PNorm = 36.6001, GNorm = 0.3388, lr_0 = 2.9576e-04
Loss = 1.0575e+00, PNorm = 36.6270, GNorm = 0.4965, lr_0 = 2.9205e-04
Validation cross_entropy = 1.141508
Epoch 27
Loss = 1.0559e+00, PNorm = 36.6494, GNorm = 0.3131, lr_0 = 2.8839e-04
Loss = 1.0486e+00, PNorm = 36.6755, GNorm = 0.3264, lr_0 = 2.8477e-04
Loss = 1.0496e+00, PNorm = 36.7027, GNorm = 0.3844, lr_0 = 2.8120e-04
Loss = 1.0485e+00, PNorm = 36.7280, GNorm = 0.2947, lr_0 = 2.7767e-04
Validation cross_entropy = 1.128285
Epoch 28
Loss = 1.0380e+00, PNorm = 36.7577, GNorm = 0.3820, lr_0 = 2.7384e-04
Loss = 1.0473e+00, PNorm = 36.7845, GNorm = 0.6840, lr_0 = 2.7041e-04
Loss = 1.0581e+00, PNorm = 36.8078, GNorm = 0.7605, lr_0 = 2.6701e-04
Validation cross_entropy = 1.125078
Epoch 29
Loss = 1.0787e+00, PNorm = 36.8348, GNorm = 0.5837, lr_0 = 2.6333e-04
Loss = 1.0417e+00, PNorm = 36.8576, GNorm = 0.7983, lr_0 = 2.6003e-04
Loss = 1.0360e+00, PNorm = 36.8855, GNorm = 0.4397, lr_0 = 2.5677e-04
Loss = 1.0509e+00, PNorm = 36.9109, GNorm = 0.5515, lr_0 = 2.5355e-04
Validation cross_entropy = 1.136531
Epoch 30
Loss = 1.0662e+00, PNorm = 36.9315, GNorm = 0.5328, lr_0 = 2.5005e-04
Loss = 1.0477e+00, PNorm = 36.9503, GNorm = 0.6012, lr_0 = 2.4691e-04
Loss = 1.0339e+00, PNorm = 36.9746, GNorm = 0.3743, lr_0 = 2.4382e-04
Loss = 1.0358e+00, PNorm = 36.9997, GNorm = 0.4959, lr_0 = 2.4076e-04
Validation cross_entropy = 1.140560
Epoch 31
Loss = 1.0333e+00, PNorm = 37.0213, GNorm = 0.6837, lr_0 = 2.3774e-04
Loss = 1.0388e+00, PNorm = 37.0449, GNorm = 0.6958, lr_0 = 2.3475e-04
Loss = 1.0498e+00, PNorm = 37.0620, GNorm = 0.3193, lr_0 = 2.3181e-04
Loss = 1.0460e+00, PNorm = 37.0828, GNorm = 0.7506, lr_0 = 2.2890e-04
Validation cross_entropy = 1.138188
Epoch 32
Loss = 1.0389e+00, PNorm = 37.1015, GNorm = 0.5549, lr_0 = 2.2575e-04
Loss = 1.0354e+00, PNorm = 37.1221, GNorm = 0.5109, lr_0 = 2.2291e-04
Loss = 1.0395e+00, PNorm = 37.1452, GNorm = 0.5266, lr_0 = 2.2012e-04
Loss = 1.0393e+00, PNorm = 37.1650, GNorm = 0.6016, lr_0 = 2.1736e-04
Validation cross_entropy = 1.146847
Epoch 33
Loss = 1.0244e+00, PNorm = 37.1899, GNorm = 0.5440, lr_0 = 2.1436e-04
Loss = 1.0268e+00, PNorm = 37.2135, GNorm = 0.7660, lr_0 = 2.1167e-04
Loss = 1.0222e+00, PNorm = 37.2367, GNorm = 0.4769, lr_0 = 2.0901e-04
Loss = 1.0425e+00, PNorm = 37.2540, GNorm = 0.7440, lr_0 = 2.0639e-04
Validation cross_entropy = 1.164420
Epoch 34
Loss = 1.0308e+00, PNorm = 37.2695, GNorm = 0.5026, lr_0 = 2.0380e-04
Loss = 1.0349e+00, PNorm = 37.2868, GNorm = 0.6740, lr_0 = 2.0125e-04
Loss = 1.0343e+00, PNorm = 37.3081, GNorm = 0.5921, lr_0 = 1.9872e-04
Validation cross_entropy = 1.164538
Epoch 35
Loss = 1.0188e+00, PNorm = 37.3249, GNorm = 0.4684, lr_0 = 1.9598e-04
Loss = 1.0335e+00, PNorm = 37.3430, GNorm = 0.6874, lr_0 = 1.9352e-04
Loss = 1.0132e+00, PNorm = 37.3623, GNorm = 0.4167, lr_0 = 1.9110e-04
Loss = 1.0235e+00, PNorm = 37.3840, GNorm = 0.6638, lr_0 = 1.8870e-04
Validation cross_entropy = 1.166118
Epoch 36
Loss = 1.0118e+00, PNorm = 37.4022, GNorm = 0.4570, lr_0 = 1.8610e-04
Loss = 1.0193e+00, PNorm = 37.4198, GNorm = 0.7143, lr_0 = 1.8376e-04
Loss = 1.0290e+00, PNorm = 37.4397, GNorm = 0.6434, lr_0 = 1.8146e-04
Loss = 1.0190e+00, PNorm = 37.4572, GNorm = 0.5319, lr_0 = 1.7918e-04
Validation cross_entropy = 1.158967
Epoch 37
Loss = 1.0057e+00, PNorm = 37.4754, GNorm = 0.6923, lr_0 = 1.7671e-04
Loss = 1.0071e+00, PNorm = 37.4926, GNorm = 0.7604, lr_0 = 1.7449e-04
Loss = 1.0333e+00, PNorm = 37.5100, GNorm = 0.6664, lr_0 = 1.7230e-04
Loss = 1.0262e+00, PNorm = 37.5260, GNorm = 0.5904, lr_0 = 1.7014e-04
Validation cross_entropy = 1.148187
Epoch 38
Loss = 1.0198e+00, PNorm = 37.5410, GNorm = 0.8976, lr_0 = 1.6801e-04
Loss = 1.0031e+00, PNorm = 37.5589, GNorm = 0.6165, lr_0 = 1.6590e-04
Loss = 1.0155e+00, PNorm = 37.5766, GNorm = 0.6699, lr_0 = 1.6382e-04
Loss = 1.0223e+00, PNorm = 37.5910, GNorm = 0.6719, lr_0 = 1.6176e-04
Validation cross_entropy = 1.159431
Epoch 39
Loss = 9.9823e-01, PNorm = 37.6075, GNorm = 0.8740, lr_0 = 1.5953e-04
Loss = 1.0301e+00, PNorm = 37.6221, GNorm = 0.6083, lr_0 = 1.5753e-04
Loss = 1.0117e+00, PNorm = 37.6371, GNorm = 0.7024, lr_0 = 1.5556e-04
Loss = 1.0106e+00, PNorm = 37.6517, GNorm = 0.7901, lr_0 = 1.5360e-04
Loss = 9.7805e-01, PNorm = 37.6532, GNorm = 1.6101, lr_0 = 1.5341e-04
Validation cross_entropy = 1.159140
Epoch 40
Loss = 1.0195e+00, PNorm = 37.6678, GNorm = 0.6374, lr_0 = 1.5149e-04
Loss = 1.0036e+00, PNorm = 37.6837, GNorm = 0.5522, lr_0 = 1.4959e-04
Loss = 1.0115e+00, PNorm = 37.6990, GNorm = 0.7648, lr_0 = 1.4771e-04
Validation cross_entropy = 1.159087
Epoch 41
Loss = 1.0140e+00, PNorm = 37.7138, GNorm = 0.8984, lr_0 = 1.4567e-04
Loss = 1.0101e+00, PNorm = 37.7284, GNorm = 0.5407, lr_0 = 1.4384e-04
Loss = 1.0076e+00, PNorm = 37.7429, GNorm = 0.6360, lr_0 = 1.4204e-04
Loss = 1.0075e+00, PNorm = 37.7572, GNorm = 0.8361, lr_0 = 1.4026e-04
Validation cross_entropy = 1.164123
Epoch 42
Loss = 9.8799e-01, PNorm = 37.7701, GNorm = 0.6794, lr_0 = 1.3850e-04
Loss = 1.0041e+00, PNorm = 37.7855, GNorm = 0.6786, lr_0 = 1.3676e-04
Loss = 1.0068e+00, PNorm = 37.7981, GNorm = 0.5287, lr_0 = 1.3505e-04
Loss = 1.0050e+00, PNorm = 37.8116, GNorm = 0.6171, lr_0 = 1.3335e-04
Validation cross_entropy = 1.166762
Epoch 43
Loss = 9.8559e-01, PNorm = 37.8245, GNorm = 0.8973, lr_0 = 1.3151e-04
Loss = 9.9487e-01, PNorm = 37.8380, GNorm = 0.6386, lr_0 = 1.2986e-04
Loss = 9.9279e-01, PNorm = 37.8514, GNorm = 0.8305, lr_0 = 1.2823e-04
Loss = 1.0147e+00, PNorm = 37.8631, GNorm = 0.6869, lr_0 = 1.2663e-04
Validation cross_entropy = 1.164503
Epoch 44
Loss = 1.0128e+00, PNorm = 37.8729, GNorm = 0.7674, lr_0 = 1.2488e-04
Loss = 9.9695e-01, PNorm = 37.8839, GNorm = 0.6787, lr_0 = 1.2331e-04
Loss = 9.9276e-01, PNorm = 37.8969, GNorm = 0.7078, lr_0 = 1.2177e-04
Loss = 1.0193e+00, PNorm = 37.9096, GNorm = 1.1071, lr_0 = 1.2024e-04
Validation cross_entropy = 1.165969
Epoch 45
Loss = 1.0139e+00, PNorm = 37.9204, GNorm = 0.5208, lr_0 = 1.1858e-04
Loss = 1.0086e+00, PNorm = 37.9317, GNorm = 0.6005, lr_0 = 1.1709e-04
Loss = 9.9344e-01, PNorm = 37.9423, GNorm = 0.6599, lr_0 = 1.1562e-04
Loss = 9.9680e-01, PNorm = 37.9531, GNorm = 1.0785, lr_0 = 1.1417e-04
Validation cross_entropy = 1.174046
Epoch 46
Loss = 1.0096e+00, PNorm = 37.9632, GNorm = 0.7553, lr_0 = 1.1274e-04
Loss = 1.0064e+00, PNorm = 37.9719, GNorm = 0.5659, lr_0 = 1.1133e-04
Loss = 9.7888e-01, PNorm = 37.9824, GNorm = 1.1000, lr_0 = 1.0993e-04
Validation cross_entropy = 1.186274
Epoch 47
Loss = 9.7902e-01, PNorm = 37.9944, GNorm = 1.0865, lr_0 = 1.0841e-04
Loss = 9.8969e-01, PNorm = 38.0036, GNorm = 0.8393, lr_0 = 1.0705e-04
Loss = 9.9778e-01, PNorm = 38.0139, GNorm = 0.6829, lr_0 = 1.0571e-04
Loss = 9.9568e-01, PNorm = 38.0225, GNorm = 0.7055, lr_0 = 1.0439e-04
Validation cross_entropy = 1.173348
Epoch 48
Loss = 9.7979e-01, PNorm = 38.0335, GNorm = 0.8662, lr_0 = 1.0295e-04
Loss = 9.9508e-01, PNorm = 38.0432, GNorm = 0.6815, lr_0 = 1.0165e-04
Loss = 9.7222e-01, PNorm = 38.0535, GNorm = 0.7539, lr_0 = 1.0038e-04
Loss = 1.0119e+00, PNorm = 38.0618, GNorm = 0.6955, lr_0 = 1.0000e-04
Validation cross_entropy = 1.172205
Epoch 49
Loss = 9.8762e-01, PNorm = 38.0705, GNorm = 0.7232, lr_0 = 1.0000e-04
Loss = 9.8735e-01, PNorm = 38.0791, GNorm = 0.8491, lr_0 = 1.0000e-04
Loss = 9.9908e-01, PNorm = 38.0885, GNorm = 0.8920, lr_0 = 1.0000e-04
Loss = 9.8452e-01, PNorm = 38.0964, GNorm = 0.5112, lr_0 = 1.0000e-04
Validation cross_entropy = 1.175394
Model 3 best validation cross_entropy = 1.097044 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 3 test cross_entropy = 1.098575
Building model 4
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1241e+00, PNorm = 33.9997, GNorm = 1.1086, lr_0 = 2.3026e-04
Loss = 1.1098e+00, PNorm = 33.9994, GNorm = 0.3543, lr_0 = 3.4868e-04
Loss = 1.1035e+00, PNorm = 34.0008, GNorm = 0.3719, lr_0 = 4.6711e-04
Validation cross_entropy = 1.097255
Epoch 1
Loss = 1.0999e+00, PNorm = 34.0040, GNorm = 0.7287, lr_0 = 5.9737e-04
Loss = 1.1029e+00, PNorm = 34.0098, GNorm = 0.3241, lr_0 = 7.1579e-04
Loss = 1.1023e+00, PNorm = 34.0169, GNorm = 0.5763, lr_0 = 8.3421e-04
Loss = 1.1021e+00, PNorm = 34.0269, GNorm = 0.1920, lr_0 = 9.5263e-04
Validation cross_entropy = 1.107586
Epoch 2
Loss = 1.1017e+00, PNorm = 34.0453, GNorm = 0.1528, lr_0 = 9.9120e-04
Loss = 1.0989e+00, PNorm = 34.0614, GNorm = 0.3833, lr_0 = 9.7877e-04
Loss = 1.0971e+00, PNorm = 34.0774, GNorm = 0.3919, lr_0 = 9.6649e-04
Loss = 1.0994e+00, PNorm = 34.0893, GNorm = 0.2966, lr_0 = 9.5437e-04
Validation cross_entropy = 1.097794
Epoch 3
Loss = 1.0947e+00, PNorm = 34.1024, GNorm = 0.1561, lr_0 = 9.4120e-04
Loss = 1.0961e+00, PNorm = 34.1153, GNorm = 0.2419, lr_0 = 9.2940e-04
Loss = 1.0990e+00, PNorm = 34.1269, GNorm = 0.1547, lr_0 = 9.1774e-04
Loss = 1.0958e+00, PNorm = 34.1388, GNorm = 0.1334, lr_0 = 9.0623e-04
Validation cross_entropy = 1.099361
Epoch 4
Loss = 1.0953e+00, PNorm = 34.1508, GNorm = 0.2158, lr_0 = 8.9486e-04
Loss = 1.0945e+00, PNorm = 34.1648, GNorm = 0.2426, lr_0 = 8.8363e-04
Loss = 1.0950e+00, PNorm = 34.1788, GNorm = 0.1632, lr_0 = 8.7255e-04
Loss = 1.0972e+00, PNorm = 34.1955, GNorm = 0.1764, lr_0 = 8.6160e-04
Validation cross_entropy = 1.094100
Epoch 5
Loss = 1.0954e+00, PNorm = 34.2181, GNorm = 0.1930, lr_0 = 8.4972e-04
Loss = 1.0925e+00, PNorm = 34.2382, GNorm = 0.1396, lr_0 = 8.3906e-04
Loss = 1.0936e+00, PNorm = 34.2612, GNorm = 0.3471, lr_0 = 8.2854e-04
Validation cross_entropy = 1.114495
Epoch 6
Loss = 1.1160e+00, PNorm = 34.2812, GNorm = 0.3191, lr_0 = 8.1711e-04
Loss = 1.0943e+00, PNorm = 34.3016, GNorm = 0.3554, lr_0 = 8.0686e-04
Loss = 1.0955e+00, PNorm = 34.3217, GNorm = 0.1405, lr_0 = 7.9674e-04
Loss = 1.0941e+00, PNorm = 34.3397, GNorm = 0.0949, lr_0 = 7.8674e-04
Validation cross_entropy = 1.099461
Epoch 7
Loss = 1.0887e+00, PNorm = 34.3585, GNorm = 0.0943, lr_0 = 7.7589e-04
Loss = 1.0919e+00, PNorm = 34.3808, GNorm = 0.1414, lr_0 = 7.6616e-04
Loss = 1.0913e+00, PNorm = 34.4054, GNorm = 0.2562, lr_0 = 7.5655e-04
Loss = 1.0915e+00, PNorm = 34.4284, GNorm = 0.1790, lr_0 = 7.4706e-04
Validation cross_entropy = 1.100457
Epoch 8
Loss = 1.0928e+00, PNorm = 34.4513, GNorm = 0.2467, lr_0 = 7.3769e-04
Loss = 1.0919e+00, PNorm = 34.4778, GNorm = 0.2341, lr_0 = 7.2843e-04
Loss = 1.0903e+00, PNorm = 34.5032, GNorm = 0.1713, lr_0 = 7.1930e-04
Loss = 1.0836e+00, PNorm = 34.5310, GNorm = 0.1598, lr_0 = 7.1027e-04
Validation cross_entropy = 1.099758
Epoch 9
Loss = 1.0861e+00, PNorm = 34.5566, GNorm = 0.2268, lr_0 = 7.0048e-04
Loss = 1.0864e+00, PNorm = 34.5888, GNorm = 0.1506, lr_0 = 6.9169e-04
Loss = 1.0913e+00, PNorm = 34.6084, GNorm = 0.2025, lr_0 = 6.8301e-04
Loss = 1.0946e+00, PNorm = 34.6360, GNorm = 0.2109, lr_0 = 6.7445e-04
Validation cross_entropy = 1.095296
Epoch 10
Loss = 1.0872e+00, PNorm = 34.6680, GNorm = 0.3120, lr_0 = 6.6515e-04
Loss = 1.0890e+00, PNorm = 34.6937, GNorm = 0.2022, lr_0 = 6.5680e-04
Loss = 1.0910e+00, PNorm = 34.7173, GNorm = 0.1684, lr_0 = 6.4856e-04
Loss = 1.0846e+00, PNorm = 34.7506, GNorm = 0.1656, lr_0 = 6.4043e-04
Loss = 1.0597e+00, PNorm = 34.7542, GNorm = 0.2881, lr_0 = 6.3962e-04
Validation cross_entropy = 1.103952
Epoch 11
Loss = 1.0866e+00, PNorm = 34.7816, GNorm = 0.4601, lr_0 = 6.3159e-04
Loss = 1.0888e+00, PNorm = 34.8192, GNorm = 0.1865, lr_0 = 6.2367e-04
Loss = 1.0895e+00, PNorm = 34.8456, GNorm = 0.1912, lr_0 = 6.1585e-04
Validation cross_entropy = 1.104443
Epoch 12
Loss = 1.0819e+00, PNorm = 34.8765, GNorm = 0.1124, lr_0 = 6.0812e-04
Loss = 1.0834e+00, PNorm = 34.9155, GNorm = 0.3290, lr_0 = 6.0049e-04
Loss = 1.0797e+00, PNorm = 34.9499, GNorm = 0.1512, lr_0 = 5.9296e-04
Loss = 1.0869e+00, PNorm = 34.9831, GNorm = 0.1290, lr_0 = 5.8552e-04
Validation cross_entropy = 1.098968
Epoch 13
Loss = 1.0828e+00, PNorm = 35.0077, GNorm = 0.1953, lr_0 = 5.7745e-04
Loss = 1.0841e+00, PNorm = 35.0344, GNorm = 0.1498, lr_0 = 5.7020e-04
Loss = 1.0822e+00, PNorm = 35.0632, GNorm = 0.2453, lr_0 = 5.6305e-04
Loss = 1.0795e+00, PNorm = 35.0979, GNorm = 0.2275, lr_0 = 5.5599e-04
Validation cross_entropy = 1.100395
Epoch 14
Loss = 1.0718e+00, PNorm = 35.1354, GNorm = 0.2573, lr_0 = 5.4832e-04
Loss = 1.0816e+00, PNorm = 35.1695, GNorm = 0.2958, lr_0 = 5.4144e-04
Loss = 1.0841e+00, PNorm = 35.1932, GNorm = 0.1905, lr_0 = 5.3465e-04
Loss = 1.0769e+00, PNorm = 35.2256, GNorm = 0.2653, lr_0 = 5.2794e-04
Validation cross_entropy = 1.107004
Epoch 15
Loss = 1.0714e+00, PNorm = 35.2674, GNorm = 0.3053, lr_0 = 5.2066e-04
Loss = 1.0749e+00, PNorm = 35.3013, GNorm = 0.2577, lr_0 = 5.1413e-04
Loss = 1.0886e+00, PNorm = 35.3323, GNorm = 0.2742, lr_0 = 5.0768e-04
Loss = 1.0742e+00, PNorm = 35.3624, GNorm = 0.1649, lr_0 = 5.0131e-04
Validation cross_entropy = 1.100640
Epoch 16
Loss = 1.0761e+00, PNorm = 35.3934, GNorm = 0.2943, lr_0 = 4.9503e-04
Loss = 1.0751e+00, PNorm = 35.4280, GNorm = 0.4125, lr_0 = 4.8882e-04
Loss = 1.0724e+00, PNorm = 35.4676, GNorm = 0.2822, lr_0 = 4.8268e-04
Loss = 1.0762e+00, PNorm = 35.5009, GNorm = 0.3506, lr_0 = 4.7663e-04
Loss = 1.1058e+00, PNorm = 35.5029, GNorm = 0.5216, lr_0 = 4.7603e-04
Validation cross_entropy = 1.110731
Epoch 17
Loss = 1.0663e+00, PNorm = 35.5341, GNorm = 0.3072, lr_0 = 4.7006e-04
Loss = 1.0753e+00, PNorm = 35.5668, GNorm = 0.3173, lr_0 = 4.6416e-04
Loss = 1.0759e+00, PNorm = 35.6002, GNorm = 0.2148, lr_0 = 4.5834e-04
Validation cross_entropy = 1.106836
Epoch 18
Loss = 1.0551e+00, PNorm = 35.6340, GNorm = 0.4108, lr_0 = 4.5202e-04
Loss = 1.0750e+00, PNorm = 35.6700, GNorm = 0.2072, lr_0 = 4.4635e-04
Loss = 1.0726e+00, PNorm = 35.7056, GNorm = 0.2924, lr_0 = 4.4075e-04
Loss = 1.0731e+00, PNorm = 35.7359, GNorm = 0.1817, lr_0 = 4.3522e-04
Validation cross_entropy = 1.108316
Epoch 19
Loss = 1.0805e+00, PNorm = 35.7602, GNorm = 0.4036, lr_0 = 4.2976e-04
Loss = 1.0712e+00, PNorm = 35.7899, GNorm = 0.2428, lr_0 = 4.2437e-04
Loss = 1.0730e+00, PNorm = 35.8265, GNorm = 0.4345, lr_0 = 4.1904e-04
Loss = 1.0809e+00, PNorm = 35.8579, GNorm = 0.4609, lr_0 = 4.1379e-04
Validation cross_entropy = 1.107703
Epoch 20
Loss = 1.0600e+00, PNorm = 35.8953, GNorm = 0.2389, lr_0 = 4.0808e-04
Loss = 1.0704e+00, PNorm = 35.9273, GNorm = 0.2127, lr_0 = 4.0296e-04
Loss = 1.0685e+00, PNorm = 35.9575, GNorm = 0.3618, lr_0 = 3.9791e-04
Loss = 1.0647e+00, PNorm = 35.9908, GNorm = 0.2899, lr_0 = 3.9291e-04
Validation cross_entropy = 1.106987
Epoch 21
Loss = 1.0626e+00, PNorm = 36.0253, GNorm = 0.3308, lr_0 = 3.8750e-04
Loss = 1.0592e+00, PNorm = 36.0560, GNorm = 0.2267, lr_0 = 3.8264e-04
Loss = 1.0595e+00, PNorm = 36.0886, GNorm = 0.2572, lr_0 = 3.7784e-04
Loss = 1.0680e+00, PNorm = 36.1167, GNorm = 0.2457, lr_0 = 3.7310e-04
Validation cross_entropy = 1.116575
Epoch 22
Loss = 1.0529e+00, PNorm = 36.1559, GNorm = 0.3914, lr_0 = 3.6795e-04
Loss = 1.0529e+00, PNorm = 36.1931, GNorm = 0.3020, lr_0 = 3.6333e-04
Loss = 1.0700e+00, PNorm = 36.2244, GNorm = 0.5778, lr_0 = 3.5878e-04
Loss = 1.0620e+00, PNorm = 36.2479, GNorm = 0.6466, lr_0 = 3.5428e-04
Validation cross_entropy = 1.119891
Epoch 23
Loss = 1.0507e+00, PNorm = 36.2794, GNorm = 0.3318, lr_0 = 3.4983e-04
Loss = 1.0616e+00, PNorm = 36.3114, GNorm = 0.3165, lr_0 = 3.4544e-04
Loss = 1.0515e+00, PNorm = 36.3408, GNorm = 0.3902, lr_0 = 3.4111e-04
Validation cross_entropy = 1.122391
Epoch 24
Loss = 1.0124e+00, PNorm = 36.3768, GNorm = 0.5006, lr_0 = 3.3641e-04
Loss = 1.0781e+00, PNorm = 36.4016, GNorm = 0.5744, lr_0 = 3.3219e-04
Loss = 1.0638e+00, PNorm = 36.4269, GNorm = 0.4381, lr_0 = 3.2802e-04
Loss = 1.0547e+00, PNorm = 36.4573, GNorm = 0.2390, lr_0 = 3.2390e-04
Validation cross_entropy = 1.126233
Epoch 25
Loss = 1.0313e+00, PNorm = 36.4896, GNorm = 0.5115, lr_0 = 3.1944e-04
Loss = 1.0585e+00, PNorm = 36.5216, GNorm = 0.3689, lr_0 = 3.1543e-04
Loss = 1.0580e+00, PNorm = 36.5497, GNorm = 0.5340, lr_0 = 3.1147e-04
Loss = 1.0473e+00, PNorm = 36.5782, GNorm = 0.7465, lr_0 = 3.0757e-04
Validation cross_entropy = 1.133457
Epoch 26
Loss = 1.0612e+00, PNorm = 36.6065, GNorm = 0.3144, lr_0 = 3.0332e-04
Loss = 1.0511e+00, PNorm = 36.6307, GNorm = 0.4365, lr_0 = 2.9952e-04
Loss = 1.0411e+00, PNorm = 36.6592, GNorm = 0.3611, lr_0 = 2.9576e-04
Loss = 1.0477e+00, PNorm = 36.6836, GNorm = 0.5980, lr_0 = 2.9205e-04
Validation cross_entropy = 1.136781
Epoch 27
Loss = 1.0433e+00, PNorm = 36.7122, GNorm = 0.4511, lr_0 = 2.8839e-04
Loss = 1.0409e+00, PNorm = 36.7428, GNorm = 0.5083, lr_0 = 2.8477e-04
Loss = 1.0368e+00, PNorm = 36.7748, GNorm = 0.3573, lr_0 = 2.8120e-04
Loss = 1.0571e+00, PNorm = 36.7993, GNorm = 0.4640, lr_0 = 2.7767e-04
Validation cross_entropy = 1.126888
Epoch 28
Loss = 1.0340e+00, PNorm = 36.8268, GNorm = 0.5038, lr_0 = 2.7384e-04
Loss = 1.0428e+00, PNorm = 36.8528, GNorm = 0.5577, lr_0 = 2.7041e-04
Loss = 1.0447e+00, PNorm = 36.8796, GNorm = 0.3788, lr_0 = 2.6701e-04
Validation cross_entropy = 1.148115
Epoch 29
Loss = 1.0604e+00, PNorm = 36.9091, GNorm = 0.5387, lr_0 = 2.6333e-04
Loss = 1.0343e+00, PNorm = 36.9376, GNorm = 0.5234, lr_0 = 2.6003e-04
Loss = 1.0439e+00, PNorm = 36.9652, GNorm = 0.3560, lr_0 = 2.5677e-04
Loss = 1.0402e+00, PNorm = 36.9889, GNorm = 0.4489, lr_0 = 2.5355e-04
Validation cross_entropy = 1.162636
Epoch 30
Loss = 1.0200e+00, PNorm = 37.0175, GNorm = 0.4973, lr_0 = 2.5005e-04
Loss = 1.0363e+00, PNorm = 37.0445, GNorm = 0.5963, lr_0 = 2.4691e-04
Loss = 1.0383e+00, PNorm = 37.0669, GNorm = 0.3777, lr_0 = 2.4382e-04
Loss = 1.0402e+00, PNorm = 37.0890, GNorm = 0.3921, lr_0 = 2.4076e-04
Validation cross_entropy = 1.144871
Epoch 31
Loss = 1.0361e+00, PNorm = 37.1123, GNorm = 0.5467, lr_0 = 2.3774e-04
Loss = 1.0347e+00, PNorm = 37.1359, GNorm = 0.4316, lr_0 = 2.3475e-04
Loss = 1.0301e+00, PNorm = 37.1617, GNorm = 0.5238, lr_0 = 2.3181e-04
Loss = 1.0255e+00, PNorm = 37.1866, GNorm = 0.4626, lr_0 = 2.2890e-04
Validation cross_entropy = 1.147391
Epoch 32
Loss = 1.0235e+00, PNorm = 37.2092, GNorm = 0.4086, lr_0 = 2.2575e-04
Loss = 1.0314e+00, PNorm = 37.2315, GNorm = 0.8166, lr_0 = 2.2291e-04
Loss = 1.0355e+00, PNorm = 37.2529, GNorm = 0.5427, lr_0 = 2.2012e-04
Loss = 1.0141e+00, PNorm = 37.2759, GNorm = 0.8265, lr_0 = 2.1736e-04
Validation cross_entropy = 1.154477
Epoch 33
Loss = 1.0158e+00, PNorm = 37.3047, GNorm = 0.5536, lr_0 = 2.1436e-04
Loss = 1.0289e+00, PNorm = 37.3279, GNorm = 0.7750, lr_0 = 2.1167e-04
Loss = 1.0215e+00, PNorm = 37.3483, GNorm = 0.4289, lr_0 = 2.0901e-04
Loss = 1.0319e+00, PNorm = 37.3704, GNorm = 0.4943, lr_0 = 2.0639e-04
Validation cross_entropy = 1.154603
Epoch 34
Loss = 1.0427e+00, PNorm = 37.3911, GNorm = 0.4628, lr_0 = 2.0380e-04
Loss = 1.0196e+00, PNorm = 37.4124, GNorm = 0.4670, lr_0 = 2.0125e-04
Loss = 1.0191e+00, PNorm = 37.4301, GNorm = 0.6033, lr_0 = 1.9872e-04
Validation cross_entropy = 1.144274
Epoch 35
Loss = 1.0046e+00, PNorm = 37.4515, GNorm = 0.5245, lr_0 = 1.9598e-04
Loss = 1.0281e+00, PNorm = 37.4697, GNorm = 0.7199, lr_0 = 1.9352e-04
Loss = 1.0170e+00, PNorm = 37.4908, GNorm = 0.4231, lr_0 = 1.9110e-04
Loss = 1.0128e+00, PNorm = 37.5092, GNorm = 0.5183, lr_0 = 1.8870e-04
Validation cross_entropy = 1.157846
Epoch 36
Loss = 1.0047e+00, PNorm = 37.5334, GNorm = 0.7454, lr_0 = 1.8610e-04
Loss = 1.0073e+00, PNorm = 37.5523, GNorm = 0.5150, lr_0 = 1.8376e-04
Loss = 1.0246e+00, PNorm = 37.5696, GNorm = 0.5962, lr_0 = 1.8146e-04
Loss = 1.0040e+00, PNorm = 37.5888, GNorm = 0.7050, lr_0 = 1.7918e-04
Validation cross_entropy = 1.167375
Epoch 37
Loss = 1.0058e+00, PNorm = 37.6080, GNorm = 0.6027, lr_0 = 1.7671e-04
Loss = 1.0175e+00, PNorm = 37.6262, GNorm = 0.5552, lr_0 = 1.7449e-04
Loss = 1.0035e+00, PNorm = 37.6435, GNorm = 0.4513, lr_0 = 1.7230e-04
Loss = 1.0109e+00, PNorm = 37.6605, GNorm = 0.6804, lr_0 = 1.7014e-04
Validation cross_entropy = 1.156555
Epoch 38
Loss = 1.0006e+00, PNorm = 37.6779, GNorm = 0.5932, lr_0 = 1.6801e-04
Loss = 9.9987e-01, PNorm = 37.6959, GNorm = 0.5687, lr_0 = 1.6590e-04
Loss = 1.0041e+00, PNorm = 37.7118, GNorm = 0.6745, lr_0 = 1.6382e-04
Loss = 1.0101e+00, PNorm = 37.7276, GNorm = 0.6660, lr_0 = 1.6176e-04
Validation cross_entropy = 1.161415
Epoch 39
Loss = 1.0098e+00, PNorm = 37.7459, GNorm = 0.5685, lr_0 = 1.5953e-04
Loss = 1.0015e+00, PNorm = 37.7624, GNorm = 0.8044, lr_0 = 1.5753e-04
Loss = 9.9970e-01, PNorm = 37.7761, GNorm = 0.4530, lr_0 = 1.5556e-04
Loss = 1.0065e+00, PNorm = 37.7914, GNorm = 0.7000, lr_0 = 1.5360e-04
Loss = 1.0080e+00, PNorm = 37.7927, GNorm = 1.0191, lr_0 = 1.5341e-04
Validation cross_entropy = 1.163575
Epoch 40
Loss = 9.9979e-01, PNorm = 37.8064, GNorm = 0.8034, lr_0 = 1.5149e-04
Loss = 1.0142e+00, PNorm = 37.8228, GNorm = 0.6297, lr_0 = 1.4959e-04
Loss = 1.0042e+00, PNorm = 37.8346, GNorm = 1.0003, lr_0 = 1.4771e-04
Validation cross_entropy = 1.162035
Epoch 41
Loss = 9.7528e-01, PNorm = 37.8523, GNorm = 0.6798, lr_0 = 1.4567e-04
Loss = 9.8347e-01, PNorm = 37.8694, GNorm = 0.7367, lr_0 = 1.4384e-04
Loss = 1.0085e+00, PNorm = 37.8826, GNorm = 0.7467, lr_0 = 1.4204e-04
Loss = 9.9299e-01, PNorm = 37.8959, GNorm = 0.5707, lr_0 = 1.4026e-04
Validation cross_entropy = 1.165604
Epoch 42
Loss = 9.8866e-01, PNorm = 37.9103, GNorm = 0.7317, lr_0 = 1.3850e-04
Loss = 9.9159e-01, PNorm = 37.9260, GNorm = 0.8584, lr_0 = 1.3676e-04
Loss = 9.8743e-01, PNorm = 37.9394, GNorm = 0.8708, lr_0 = 1.3505e-04
Loss = 1.0024e+00, PNorm = 37.9531, GNorm = 0.7776, lr_0 = 1.3335e-04
Validation cross_entropy = 1.176596
Epoch 43
Loss = 9.5974e-01, PNorm = 37.9671, GNorm = 0.5639, lr_0 = 1.3151e-04
Loss = 9.8509e-01, PNorm = 37.9814, GNorm = 0.6234, lr_0 = 1.2986e-04
Loss = 9.8253e-01, PNorm = 37.9947, GNorm = 0.6627, lr_0 = 1.2823e-04
Loss = 1.0123e+00, PNorm = 38.0061, GNorm = 0.7795, lr_0 = 1.2663e-04
Validation cross_entropy = 1.174229
Epoch 44
Loss = 9.8686e-01, PNorm = 38.0184, GNorm = 0.6345, lr_0 = 1.2488e-04
Loss = 9.8028e-01, PNorm = 38.0318, GNorm = 0.5341, lr_0 = 1.2331e-04
Loss = 9.8302e-01, PNorm = 38.0447, GNorm = 0.9266, lr_0 = 1.2177e-04
Loss = 9.8735e-01, PNorm = 38.0566, GNorm = 0.8445, lr_0 = 1.2024e-04
Validation cross_entropy = 1.186749
Epoch 45
Loss = 9.9335e-01, PNorm = 38.0699, GNorm = 0.9209, lr_0 = 1.1858e-04
Loss = 9.7853e-01, PNorm = 38.0815, GNorm = 0.9710, lr_0 = 1.1709e-04
Loss = 9.8366e-01, PNorm = 38.0924, GNorm = 0.6036, lr_0 = 1.1562e-04
Loss = 9.9333e-01, PNorm = 38.1030, GNorm = 1.4643, lr_0 = 1.1417e-04
Validation cross_entropy = 1.178656
Epoch 46
Loss = 9.9247e-01, PNorm = 38.1132, GNorm = 0.8233, lr_0 = 1.1274e-04
Loss = 9.9105e-01, PNorm = 38.1226, GNorm = 0.8293, lr_0 = 1.1133e-04
Loss = 9.7284e-01, PNorm = 38.1338, GNorm = 1.1171, lr_0 = 1.0993e-04
Validation cross_entropy = 1.192467
Epoch 47
Loss = 9.9509e-01, PNorm = 38.1447, GNorm = 1.2525, lr_0 = 1.0841e-04
Loss = 9.9310e-01, PNorm = 38.1533, GNorm = 0.9496, lr_0 = 1.0705e-04
Loss = 9.8116e-01, PNorm = 38.1619, GNorm = 0.7752, lr_0 = 1.0571e-04
Loss = 9.7278e-01, PNorm = 38.1722, GNorm = 1.0001, lr_0 = 1.0439e-04
Validation cross_entropy = 1.191417
Epoch 48
Loss = 9.3962e-01, PNorm = 38.1833, GNorm = 0.6109, lr_0 = 1.0295e-04
Loss = 9.6747e-01, PNorm = 38.1939, GNorm = 0.7767, lr_0 = 1.0165e-04
Loss = 9.9943e-01, PNorm = 38.2025, GNorm = 0.6148, lr_0 = 1.0038e-04
Loss = 9.6855e-01, PNorm = 38.2109, GNorm = 0.7745, lr_0 = 1.0000e-04
Validation cross_entropy = 1.181041
Epoch 49
Loss = 9.7884e-01, PNorm = 38.2198, GNorm = 1.2012, lr_0 = 1.0000e-04
Loss = 9.9191e-01, PNorm = 38.2285, GNorm = 0.6031, lr_0 = 1.0000e-04
Loss = 9.5665e-01, PNorm = 38.2388, GNorm = 0.8431, lr_0 = 1.0000e-04
Loss = 9.8580e-01, PNorm = 38.2476, GNorm = 0.9734, lr_0 = 1.0000e-04
Validation cross_entropy = 1.185221
Model 4 best validation cross_entropy = 1.094100 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 4 test cross_entropy = 1.100634
Ensemble test cross_entropy = 1.100532
1-fold cross validation
	Seed 0 ==> test cross_entropy = 1.100532
Overall test cross_entropy = 1.100532 +/- 0.000000
Elapsed time = 0:12:30
